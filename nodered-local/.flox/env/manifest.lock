{
  "lockfile-version": 1,
  "manifest": {
    "version": 1,
    "install": {
      "gum": {
        "pkg-path": "gum"
      },
      "node-red": {
        "pkg-path": "node-red"
      },
      "nodejs": {
        "pkg-path": "nodejs"
      },
      "redis": {
        "pkg-path": "redis"
      }
    },
    "vars": {
      "NODERED_CONFIG_DIR": "$FLOX_ENV_CACHE/nodered-config",
      "NODERED_DATA_DIR": "$FLOX_ENV_CACHE/nodered-data",
      "NODERED_LOG_DIR": "$FLOX_ENV_CACHE/nodered-logs",
      "REDIS_CONFIG_DIR": "$FLOX_ENV_CACHE/redis-config",
      "REDIS_DATA_DIR": "$FLOX_ENV_CACHE/redis-data",
      "REDIS_LOG_DIR": "$FLOX_ENV_CACHE/redis-logs"
    },
    "hook": {
      "on-activate": "# Create required directories\nmkdir -p \"$FLOX_ENV_CACHE/redis-config\"\nmkdir -p \"$FLOX_ENV_CACHE/redis-logs\"\nmkdir -p \"$FLOX_ENV_CACHE/redis-data\"\n\n# === RUNTIME VARIABLES - Connection ===\nexport REDIS_HOST=\"${REDIS_HOST:-127.0.0.1}\"\nexport REDIS_PORT=\"${REDIS_PORT:-16379}\"\nexport REDIS_PASSWORD=\"${REDIS_PASSWORD:-}\"\n\n# === RUNTIME VARIABLES - Memory Management ===\nexport REDIS_MAXMEMORY=\"${REDIS_MAXMEMORY:-256mb}\"\nexport REDIS_MAXMEMORY_POLICY=\"${REDIS_MAXMEMORY_POLICY:-noeviction}\"\nexport REDIS_MAXMEMORY_SAMPLES=\"${REDIS_MAXMEMORY_SAMPLES:-5}\"\n\n# === RUNTIME VARIABLES - Persistence (RDB) ===\nexport REDIS_SAVE_RDB=\"${REDIS_SAVE_RDB:-yes}\"\nexport REDIS_SAVE_900=\"${REDIS_SAVE_900:-1}\"\nexport REDIS_SAVE_300=\"${REDIS_SAVE_300:-10}\"\nexport REDIS_SAVE_60=\"${REDIS_SAVE_60:-10000}\"\nexport REDIS_RDB_COMPRESSION=\"${REDIS_RDB_COMPRESSION:-yes}\"\nexport REDIS_RDB_CHECKSUM=\"${REDIS_RDB_CHECKSUM:-yes}\"\n\n# === RUNTIME VARIABLES - Persistence (AOF) ===\nexport REDIS_APPENDONLY=\"${REDIS_APPENDONLY:-no}\"\nexport REDIS_APPENDFSYNC=\"${REDIS_APPENDFSYNC:-everysec}\"\nexport REDIS_AOF_REWRITE_PERCENTAGE=\"${REDIS_AOF_REWRITE_PERCENTAGE:-100}\"\nexport REDIS_AOF_REWRITE_MIN_SIZE=\"${REDIS_AOF_REWRITE_MIN_SIZE:-64mb}\"\n\n# === RUNTIME VARIABLES - Performance ===\nexport REDIS_DATABASES=\"${REDIS_DATABASES:-16}\"\nexport REDIS_TCP_BACKLOG=\"${REDIS_TCP_BACKLOG:-511}\"\nexport REDIS_TIMEOUT=\"${REDIS_TIMEOUT:-0}\"\nexport REDIS_TCP_KEEPALIVE=\"${REDIS_TCP_KEEPALIVE:-300}\"\nexport REDIS_MAXCLIENTS=\"${REDIS_MAXCLIENTS:-10000}\"\n\n# === RUNTIME VARIABLES - Slow Log ===\nexport REDIS_SLOWLOG_LOG_SLOWER_THAN=\"${REDIS_SLOWLOG_LOG_SLOWER_THAN:-10000}\"\nexport REDIS_SLOWLOG_MAX_LEN=\"${REDIS_SLOWLOG_MAX_LEN:-128}\"\n\n# === RUNTIME VARIABLES - Latency Monitor ===\nexport REDIS_LATENCY_MONITOR_THRESHOLD=\"${REDIS_LATENCY_MONITOR_THRESHOLD:-0}\"\n\n# === RUNTIME VARIABLES - Security ===\nexport REDIS_PROTECTED_MODE=\"${REDIS_PROTECTED_MODE:-yes}\"\nexport REDIS_RENAME_COMMANDS=\"${REDIS_RENAME_COMMANDS:-}\"\n\n# === FLEXIBILITY ===\nexport REDIS_EXTRA_OPTS=\"${REDIS_EXTRA_OPTS:-}\"\n\n# === DERIVED VARIABLES ===\nexport REDIS_DIR=\"${REDIS_DIR:-$FLOX_ENV_CACHE/redis-data}\"\nexport REDIS_CONF_FILE=\"$REDIS_CONFIG_DIR/redis.conf\"\nexport REDIS_LOG_FILE=\"$REDIS_LOG_DIR/redis.log\"\n\n# === CONFIGURATION GENERATION ===\ngenerate_redis_config() {\n    # Ensure directories exist\n    mkdir -p \"$REDIS_DIR\" \"$REDIS_CONFIG_DIR\" \"$REDIS_LOG_DIR\"\n    chmod 700 \"$REDIS_DIR\" \"$REDIS_CONFIG_DIR\"\n\n    cat > \"$REDIS_CONF_FILE\" << EOF\n# Redis configuration generated by Flox (headless mode)\n# Connection\nbind $REDIS_HOST\nport $REDIS_PORT\nprotected-mode $REDIS_PROTECTED_MODE\n\n# General\ndaemonize no\ndir $REDIS_DIR\nlogfile $REDIS_LOG_FILE\ndatabases $REDIS_DATABASES\n\n# Network\ntcp-backlog $REDIS_TCP_BACKLOG\ntimeout $REDIS_TIMEOUT\ntcp-keepalive $REDIS_TCP_KEEPALIVE\n\n# Clients\nmaxclients $REDIS_MAXCLIENTS\n\n# Memory Management\nmaxmemory $REDIS_MAXMEMORY\nmaxmemory-policy $REDIS_MAXMEMORY_POLICY\nmaxmemory-samples $REDIS_MAXMEMORY_SAMPLES\n\nEOF\n\n    # Add password if set\n    if [ -n \"$REDIS_PASSWORD\" ]; then\n        echo \"# Security\" >> \"$REDIS_CONF_FILE\"\n        echo \"requirepass $REDIS_PASSWORD\" >> \"$REDIS_CONF_FILE\"\n        echo \"\" >> \"$REDIS_CONF_FILE\"\n    fi\n\n    # Add command renaming if set\n    if [ -n \"$REDIS_RENAME_COMMANDS\" ]; then\n        echo \"# Command renaming\" >> \"$REDIS_CONF_FILE\"\n        # Format: \"FLUSHDB,FLUSHALL,CONFIG\" -> rename-command FLUSHDB \"\", rename-command FLUSHALL \"\"\n        IFS=',' read -ra CMDS <<< \"$REDIS_RENAME_COMMANDS\"\n        for cmd in \"${CMDS[@]}\"; do\n            echo \"rename-command $cmd \\\"\\\"\" >> \"$REDIS_CONF_FILE\"\n        done\n        echo \"\" >> \"$REDIS_CONF_FILE\"\n    fi\n\n    # RDB Persistence\n    echo \"# RDB Persistence\" >> \"$REDIS_CONF_FILE\"\n    if [ \"$REDIS_SAVE_RDB\" = \"yes\" ]; then\n        echo \"save 900 $REDIS_SAVE_900\" >> \"$REDIS_CONF_FILE\"\n        echo \"save 300 $REDIS_SAVE_300\" >> \"$REDIS_CONF_FILE\"\n        echo \"save 60 $REDIS_SAVE_60\" >> \"$REDIS_CONF_FILE\"\n        echo \"rdbcompression $REDIS_RDB_COMPRESSION\" >> \"$REDIS_CONF_FILE\"\n        echo \"rdbchecksum $REDIS_RDB_CHECKSUM\" >> \"$REDIS_CONF_FILE\"\n    else\n        echo \"save \\\"\\\"\" >> \"$REDIS_CONF_FILE\"\n    fi\n    echo \"\" >> \"$REDIS_CONF_FILE\"\n\n    # AOF Persistence\n    echo \"# AOF Persistence\" >> \"$REDIS_CONF_FILE\"\n    echo \"appendonly $REDIS_APPENDONLY\" >> \"$REDIS_CONF_FILE\"\n    if [ \"$REDIS_APPENDONLY\" = \"yes\" ]; then\n        echo \"appendfsync $REDIS_APPENDFSYNC\" >> \"$REDIS_CONF_FILE\"\n        echo \"auto-aof-rewrite-percentage $REDIS_AOF_REWRITE_PERCENTAGE\" >> \"$REDIS_CONF_FILE\"\n        echo \"auto-aof-rewrite-min-size $REDIS_AOF_REWRITE_MIN_SIZE\" >> \"$REDIS_CONF_FILE\"\n    fi\n    echo \"\" >> \"$REDIS_CONF_FILE\"\n\n    # Slow Log\n    echo \"# Slow Log\" >> \"$REDIS_CONF_FILE\"\n    echo \"slowlog-log-slower-than $REDIS_SLOWLOG_LOG_SLOWER_THAN\" >> \"$REDIS_CONF_FILE\"\n    echo \"slowlog-max-len $REDIS_SLOWLOG_MAX_LEN\" >> \"$REDIS_CONF_FILE\"\n    echo \"\" >> \"$REDIS_CONF_FILE\"\n\n    # Latency Monitor\n    echo \"# Latency Monitor\" >> \"$REDIS_CONF_FILE\"\n    echo \"latency-monitor-threshold $REDIS_LATENCY_MONITOR_THRESHOLD\" >> \"$REDIS_CONF_FILE\"\n\n    chmod 644 \"$REDIS_CONF_FILE\"\n    return 0\n}\n\n# Generate configuration on activation\ngenerate_redis_config\n\n# Display info with safety warnings\necho \"\"\necho \"âœ… Redis environment ready (headless mode)\"\necho \"\"\n\n# Safety warnings\nif [ \"$REDIS_PROTECTED_MODE\" = \"no\" ]; then\n    echo \"âš ï¸  WARNING: Protected mode disabled - EXPOSED TO NETWORK\"\nfi\nif [ -z \"$REDIS_PASSWORD\" ]; then\n    echo \"âš ï¸  WARNING: No password set - UNAUTHENTICATED ACCESS\"\nfi\nif [ \"$REDIS_HOST\" = \"0.0.0.0\" ]; then\n    echo \"âš ï¸  WARNING: Listening on all interfaces - NETWORK EXPOSED\"\nfi\nif [ \"$REDIS_APPENDONLY\" = \"no\" ] && [ \"$REDIS_SAVE_RDB\" = \"no\" ]; then\n    echo \"âš ï¸  WARNING: All persistence disabled - DATA LOSS ON RESTART\"\nfi\n[ \"$REDIS_PROTECTED_MODE\" = \"no\" ] || [ -z \"$REDIS_PASSWORD\" ] || [ \"$REDIS_HOST\" = \"0.0.0.0\" ] || [ \"$REDIS_APPENDONLY\" = \"no\" -a \"$REDIS_SAVE_RDB\" = \"no\" ] && echo \"\"\n\necho \"Connection:\"\necho \"  Host: ${REDIS_HOST}:${REDIS_PORT}\"\nif [ -n \"$REDIS_PASSWORD\" ]; then\n    echo \"  Password: ***\"\nelse\n    echo \"  Password: (none)\"\nfi\necho \"\"\necho \"Memory:\"\necho \"  Max memory: ${REDIS_MAXMEMORY}\"\necho \"  Eviction policy: ${REDIS_MAXMEMORY_POLICY}\"\necho \"\"\necho \"Persistence:\"\necho \"  RDB snapshots: ${REDIS_SAVE_RDB}\"\necho \"  AOF logging: ${REDIS_APPENDONLY}\"\necho \"\"\necho \"Commands:\"\necho \"  flox activate -s        Start Redis\"\necho \"  redis-cli               Connect to Redis\"\necho \"  redis-info              Show configuration\"\necho \"\"\n\n# Create required directories\nmkdir -p \"$FLOX_ENV_CACHE/nodered-config\"\nmkdir -p \"$FLOX_ENV_CACHE/nodered-data\"\nmkdir -p \"$FLOX_ENV_CACHE/nodered-logs\"\n\n# === CONFIGURATION FILES ===\nexport CONFIG_FILE=\"$FLOX_ENV_CACHE/nodered.config\"\nexport CREDENTIAL_SECRET_FILE=\"$FLOX_ENV_CACHE/nodered-credential.key\"\nexport SETTINGS_FILE=\"$NODERED_DATA_DIR/settings.js\"\n\n# === DEFAULT VALUES ===\nexport DEFAULT_PORT=\"1880\"\nexport DEFAULT_HOST=\"0.0.0.0\"\nexport DEFAULT_ADMIN_USER=\"admin\"\nexport DEFAULT_ADMIN_PASSWORD=\"admin\"\nexport DEFAULT_CONTEXT_STORAGE=\"memory\"\nexport DEFAULT_PROJECTS_ENABLED=\"true\"\nexport DEFAULT_WORKFLOW_MODE=\"manual\"\n\n# === HELPER FUNCTIONS ===\n\ncheck_first_run() {\n    if [[ ! -f \"$CONFIG_FILE\" ]]; then\n        return 0  # True, first run\n    else\n        return 1  # False, not first run\n    fi\n}\n\nload_config() {\n    if [[ -f \"$CONFIG_FILE\" ]]; then\n        source \"$CONFIG_FILE\"\n    else\n        # Set defaults if no config\n        export NODERED_PORT=\"$DEFAULT_PORT\"\n        export NODERED_HOST=\"$DEFAULT_HOST\"\n        export NODERED_ADMIN_AUTH_ENABLED=\"true\"\n        export NODERED_ADMIN_USER=\"$DEFAULT_ADMIN_USER\"\n        export NODERED_ADMIN_PASSWORD=\"$DEFAULT_ADMIN_PASSWORD\"\n        export NODERED_HTTP_AUTH_ENABLED=\"false\"\n        export NODERED_CONTEXT_STORAGE=\"$DEFAULT_CONTEXT_STORAGE\"\n        export NODERED_CUSTOM_NODES=\"minimal\"\n        export NODERED_PROJECTS_ENABLED=\"$DEFAULT_PROJECTS_ENABLED\"\n        export NODERED_PROJECTS_WORKFLOW_MODE=\"$DEFAULT_WORKFLOW_MODE\"\n    fi\n}\n\nsave_config() {\n    mkdir -p \"$(dirname \"$CONFIG_FILE\")\"\n    cat > \"$CONFIG_FILE\" << EOF\n# Node-RED configuration - Generated on $(date)\nexport NODERED_PORT=\"$NODERED_PORT\"\nexport NODERED_HOST=\"$NODERED_HOST\"\nexport NODERED_ADMIN_AUTH_ENABLED=\"$NODERED_ADMIN_AUTH_ENABLED\"\nexport NODERED_ADMIN_USER=\"$NODERED_ADMIN_USER\"\nexport NODERED_ADMIN_PASSWORD=\"$NODERED_ADMIN_PASSWORD\"\nexport NODERED_HTTP_AUTH_ENABLED=\"$NODERED_HTTP_AUTH_ENABLED\"\nexport NODERED_HTTP_USER=\"$NODERED_HTTP_USER\"\nexport NODERED_HTTP_PASSWORD=\"$NODERED_HTTP_PASSWORD\"\nexport NODERED_CONTEXT_STORAGE=\"$NODERED_CONTEXT_STORAGE\"\nexport REDIS_HOST=\"$REDIS_HOST\"\nexport REDIS_PORT=\"$REDIS_PORT\"\nexport REDIS_DB=\"$REDIS_DB\"\nexport REDIS_PASSWORD=\"$REDIS_PASSWORD\"\nexport NODERED_CUSTOM_NODES=\"$NODERED_CUSTOM_NODES\"\nexport NODERED_CUSTOM_NODES_LIST=\"$NODERED_CUSTOM_NODES_LIST\"\nexport NODERED_PROJECTS_ENABLED=\"$NODERED_PROJECTS_ENABLED\"\nexport NODERED_PROJECTS_WORKFLOW_MODE=\"$NODERED_PROJECTS_WORKFLOW_MODE\"\n\n## BEGIN ACTIVATION HOOK ##\n$(declare -f check_first_run)\n$(declare -f load_config)\n$(declare -f save_config)\n$(declare -f ensure_credential_secret)\n$(declare -f prompt_for_config)\n$(declare -f install_custom_nodes)\n$(declare -f generate_settings_js)\n$(declare -f initialize_nodered)\n$(declare -f reconfigure_nodered)\n$(declare -f main)\n## END ACTIVATION HOOK ##\nEOF\n    chmod 644 \"$CONFIG_FILE\"\n}\n\nensure_credential_secret() {\n    if [ -n \"$NODERED_CREDENTIAL_SECRET\" ]; then\n        # User provided their own secret\n        export NODERED_CREDENTIAL_SECRET\n    elif [ -f \"$CREDENTIAL_SECRET_FILE\" ]; then\n        # Load existing secret\n        export NODERED_CREDENTIAL_SECRET=$(cat \"$CREDENTIAL_SECRET_FILE\")\n    else\n        # Generate new secret\n        export NODERED_CREDENTIAL_SECRET=$(openssl rand -hex 32)\n        echo \"$NODERED_CREDENTIAL_SECRET\" > \"$CREDENTIAL_SECRET_FILE\"\n        chmod 600 \"$CREDENTIAL_SECRET_FILE\"\n        echo \"\"\n        gum style --foreground 208 \"âš ï¸  Credential secret generated and saved to:\"\n        echo \"   $CREDENTIAL_SECRET_FILE\"\n        echo \"\"\n        gum style --foreground 196 --bold \"ðŸ”’ CRITICAL: Back up this file!\"\n        echo \"   Without it, flow credentials are unrecoverable.\"\n        echo \"\"\n    fi\n}\n\nprompt_for_config() {\n    gum style --border double --padding \"1 2\" --border-foreground 212 \"\n    ðŸŽ¯ Node-RED Configuration Wizard\n\n    Configure your Node-RED workflow automation environment\n    \"\n\n    # Server configuration\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    gum style --foreground 117 \"ðŸ“¡ Server Configuration\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    echo \"\"\n\n    NODERED_PORT=$(gum input --placeholder \"$DEFAULT_PORT\" --value \"$NODERED_PORT\" --prompt \"Port: \")\n    NODERED_HOST=$(gum input --placeholder \"$DEFAULT_HOST\" --value \"$NODERED_HOST\" --prompt \"Listen address: \")\n\n    # Security configuration\n    echo \"\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    gum style --foreground 117 \"ðŸ” Security Configuration\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    echo \"\"\n\n    if gum confirm \"Enable admin authentication?\" --default=true --affirmative=\"Yes\" --negative=\"No\"; then\n        export NODERED_ADMIN_AUTH_ENABLED=\"true\"\n        NODERED_ADMIN_USER=$(gum input --placeholder \"$DEFAULT_ADMIN_USER\" --value \"$NODERED_ADMIN_USER\" --prompt \"Admin username: \")\n        NODERED_ADMIN_PASSWORD=$(gum input --placeholder \"$DEFAULT_ADMIN_PASSWORD\" --value \"$NODERED_ADMIN_PASSWORD\" --prompt \"Admin password: \" --password)\n    else\n        export NODERED_ADMIN_AUTH_ENABLED=\"false\"\n        gum style --foreground 208 \"âš ï¸  Admin authentication disabled\"\n    fi\n\n    echo \"\"\n    if gum confirm \"Enable HTTP node authentication?\" --default=false --affirmative=\"Yes\" --negative=\"No\"; then\n        export NODERED_HTTP_AUTH_ENABLED=\"true\"\n        NODERED_HTTP_USER=$(gum input --placeholder \"http-user\" --prompt \"HTTP username: \")\n        NODERED_HTTP_PASSWORD=$(gum input --placeholder \"password\" --prompt \"HTTP password: \" --password)\n    else\n        export NODERED_HTTP_AUTH_ENABLED=\"false\"\n    fi\n\n    # Context storage\n    echo \"\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    gum style --foreground 117 \"ðŸ’¾ Context Storage\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    echo \"\"\n    gum style --foreground 245 \"Memory:    Fast, not persistent\"\n    gum style --foreground 245 \"File:      Persistent, no external deps\"\n    gum style --foreground 245 \"Redis:     HA/clustering, persistent\"\n    echo \"\"\n\n    STORAGE_CHOICE=$(gum choose --header \"Select context storage:\" \"Memory\" \"File\" \"Redis\")\n\n    case \"$STORAGE_CHOICE\" in\n        \"Memory\")\n            export NODERED_CONTEXT_STORAGE=\"memory\"\n            ;;\n        \"File\")\n            export NODERED_CONTEXT_STORAGE=\"file\"\n            ;;\n        \"Redis\")\n            export NODERED_CONTEXT_STORAGE=\"redis\"\n            echo \"\"\n            REDIS_HOST=$(gum input --placeholder \"127.0.0.1\" --value \"${REDIS_HOST:-127.0.0.1}\" --prompt \"Redis host: \")\n            REDIS_PORT=$(gum input --placeholder \"16379\" --value \"${REDIS_PORT:-16379}\" --prompt \"Redis port: \")\n            REDIS_DB=$(gum input --placeholder \"0\" --value \"${REDIS_DB:-0}\" --prompt \"Redis DB: \")\n            REDIS_PASSWORD=$(gum input --placeholder \"(optional)\" --value \"${REDIS_PASSWORD:-}\" --prompt \"Redis password: \" --password)\n            ;;\n    esac\n\n    # Custom nodes\n    echo \"\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    gum style --foreground 117 \"ðŸ“¦ Custom Nodes Installation\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    echo \"\"\n    gum style --foreground 245 \"Minimal: dashboard only\"\n    gum style --foreground 245 \"Common:  dashboard + email + influxdb + mysql + postgres\"\n    gum style --foreground 245 \"Custom:  specify your own package list\"\n    echo \"\"\n\n    NODES_CHOICE=$(gum choose --header \"Select custom nodes:\" \"Minimal\" \"Common\" \"Custom\")\n\n    case \"$NODES_CHOICE\" in\n        \"Minimal\")\n            export NODERED_CUSTOM_NODES=\"minimal\"\n            ;;\n        \"Common\")\n            export NODERED_CUSTOM_NODES=\"common\"\n            ;;\n        \"Custom\")\n            export NODERED_CUSTOM_NODES=\"custom\"\n            echo \"\"\n            gum style --foreground 245 \"Enter npm package names (space-separated):\"\n            NODERED_CUSTOM_NODES_LIST=$(gum input --placeholder \"node-red-dashboard node-red-node-email\" --prompt \"Packages: \")\n            ;;\n    esac\n\n    # Projects feature\n    echo \"\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    gum style --foreground 117 \"ðŸ”§ Projects Feature (Git Integration)\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    echo \"\"\n    gum style --foreground 245 \"Projects enable Git version control within the Node-RED editor\"\n    echo \"\"\n\n    if gum confirm \"Enable projects feature?\" --default=true --affirmative=\"Yes\" --negative=\"No\"; then\n        export NODERED_PROJECTS_ENABLED=\"true\"\n        echo \"\"\n        gum style --foreground 245 \"Manual: Commit/push manually (recommended for learning)\"\n        gum style --foreground 245 \"Auto:   Auto-commit on deploy\"\n        echo \"\"\n        WORKFLOW_CHOICE=$(gum choose --header \"Workflow mode:\" \"Manual (recommended)\" \"Auto\")\n        case \"$WORKFLOW_CHOICE\" in\n            \"Manual (recommended)\")\n                export NODERED_PROJECTS_WORKFLOW_MODE=\"manual\"\n                ;;\n            \"Auto\")\n                export NODERED_PROJECTS_WORKFLOW_MODE=\"auto\"\n                ;;\n        esac\n    else\n        export NODERED_PROJECTS_ENABLED=\"false\"\n    fi\n\n    echo \"\"\n    gum style --foreground 46 \"âœ… Configuration complete!\"\n    echo \"\"\n}\n\ninstall_custom_nodes() {\n    local NODES_INSTALLED_FLAG=\"$NODERED_DATA_DIR/.nodes_installed_$NODERED_CUSTOM_NODES\"\n\n    # Check if already installed\n    if [ -f \"$NODES_INSTALLED_FLAG\" ]; then\n        return 0\n    fi\n\n    # Determine package list\n    local PACKAGES=\"\"\n    case \"$NODERED_CUSTOM_NODES\" in\n        \"minimal\")\n            PACKAGES=\"@flowfuse/node-red-dashboard\"\n            ;;\n        \"common\")\n            PACKAGES=\"@flowfuse/node-red-dashboard node-red-node-email node-red-contrib-influxdb node-red-node-mysql node-red-node-postgres\"\n            ;;\n        \"custom\")\n            PACKAGES=\"$NODERED_CUSTOM_NODES_LIST\"\n            ;;\n    esac\n\n    # Check if we need to install anything (custom nodes OR redis context)\n    local NEEDS_INSTALL=false\n    if [ -n \"$PACKAGES\" ]; then\n        NEEDS_INSTALL=true\n    fi\n    if [ \"$NODERED_CONTEXT_STORAGE\" = \"redis\" ]; then\n        NEEDS_INSTALL=true\n    fi\n\n    if [ \"$NEEDS_INSTALL\" = \"false\" ]; then\n        return 0\n    fi\n\n    echo \"\"\n    gum style --foreground 117 \"ðŸ“¦ Installing custom nodes...\"\n    echo \"\"\n\n    # Start Node-RED briefly to initialize userDir\n    timeout 10 node-red --userDir \"$NODERED_DATA_DIR\" --settings \"$SETTINGS_FILE\" &>/dev/null || true\n\n    # Wait for package.json to exist\n    for i in {1..30}; do\n        if [ -f \"$NODERED_DATA_DIR/package.json\" ]; then\n            break\n        fi\n        sleep 0.5\n    done\n\n    if [ ! -f \"$NODERED_DATA_DIR/package.json\" ]; then\n        gum style --foreground 196 \"âš ï¸  Warning: Could not initialize Node-RED userDir\"\n        gum style --foreground 245 \"   Custom nodes will need to be installed manually\"\n        return 1\n    fi\n\n    # Install nodes\n    cd \"$NODERED_DATA_DIR\"\n\n    # Install Redis context storage if needed\n    if [ \"$NODERED_CONTEXT_STORAGE\" = \"redis\" ]; then\n        echo \"  Installing node-red-context-redis...\"\n        npm install --silent --no-audit --no-fund node-red-context-redis 2>&1 | grep -v \"npm WARN\" || true\n    fi\n\n    # Install custom nodes\n    for pkg in $PACKAGES; do\n        echo \"  Installing $pkg...\"\n        npm install --silent --no-audit --no-fund \"$pkg\" 2>&1 | grep -v \"npm WARN\" || true\n    done\n\n    # Mark as installed\n    touch \"$NODES_INSTALLED_FLAG\"\n\n    echo \"\"\n    gum style --foreground 46 \"âœ… Custom nodes installed successfully\"\n    echo \"\"\n}\n\ngenerate_settings_js() {\n    # Generate bcrypt hash for admin password if auth enabled\n    local ADMIN_PASSWORD_HASH=\"\"\n    if [ \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\" ]; then\n        # Use node-red-admin to hash password\n        ADMIN_PASSWORD_HASH=$(echo \"$NODERED_ADMIN_PASSWORD\" | node-red-admin hash-pw 2>/dev/null | tail -1)\n    fi\n\n    # Generate bcrypt hash for HTTP password if auth enabled\n    local HTTP_PASSWORD_HASH=\"\"\n    if [ \"$NODERED_HTTP_AUTH_ENABLED\" = \"true\" ]; then\n        HTTP_PASSWORD_HASH=$(echo \"$NODERED_HTTP_PASSWORD\" | node-red-admin hash-pw 2>/dev/null | tail -1)\n    fi\n\n    # Generate settings.js\n    cat > \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\nmodule.exports = {\n    // Server settings\n    uiPort: process.env.NODERED_PORT || 1880,\n    uiHost: process.env.NODERED_HOST || \"0.0.0.0\",\n\n    // User directory\n    userDir: process.env.NODERED_DATA_DIR,\n\n    // Flow file\n    flowFile: process.env.NODERED_FLOW_FILE || \"flows.json\",\n\n    // Credential secret\n    credentialSecret: process.env.NODERED_CREDENTIAL_SECRET,\nSETTINGS_EOF\n\n    # Add admin authentication if enabled\n    if [ \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\" ]; then\n        cat >> \"$SETTINGS_FILE\" << SETTINGS_EOF\n\n    // Admin authentication\n    adminAuth: {\n        type: \"credentials\",\n        users: [{\n            username: \"$NODERED_ADMIN_USER\",\n            password: \"$ADMIN_PASSWORD_HASH\",\n            permissions: \"*\"\n        }]\n    },\nSETTINGS_EOF\n    fi\n\n    # Add HTTP node authentication if enabled\n    if [ \"$NODERED_HTTP_AUTH_ENABLED\" = \"true\" ]; then\n        cat >> \"$SETTINGS_FILE\" << SETTINGS_EOF\n\n    // HTTP node authentication\n    httpNodeAuth: {\n        user: \"$NODERED_HTTP_USER\",\n        pass: \"$HTTP_PASSWORD_HASH\"\n    },\nSETTINGS_EOF\n    fi\n\n    # Add context storage configuration\n    cat >> \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\n\n    // Context storage\n    contextStorage: {\nSETTINGS_EOF\n\n    case \"$NODERED_CONTEXT_STORAGE\" in\n        \"memory\")\n            cat >> \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\n        default: {\n            module: \"memory\"\n        }\nSETTINGS_EOF\n            ;;\n        \"file\")\n            cat >> \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\n        default: \"file\",\n        file: {\n            module: \"localfilesystem\"\n        }\nSETTINGS_EOF\n            ;;\n        \"redis\")\n            cat >> \"$SETTINGS_FILE\" << SETTINGS_EOF\n        default: \"redis\",\n        redis: {\n            module: require(\"node-red-context-redis\"),\n            config: {\n                host: \"$REDIS_HOST\",\n                port: $REDIS_PORT,\n                db: $REDIS_DB,\n                password: \"$REDIS_PASSWORD\",\n                prefix: \"nodered\"\n            }\n        }\nSETTINGS_EOF\n            ;;\n    esac\n\n    cat >> \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\n    },\n\n    // Logging\n    logging: {\n        console: {\n            level: \"info\",\n            metrics: false,\n            audit: false\n        }\n    },\nSETTINGS_EOF\n\n    # Add projects configuration\n    if [ \"$NODERED_PROJECTS_ENABLED\" = \"true\" ]; then\n        cat >> \"$SETTINGS_FILE\" << SETTINGS_EOF\n\n    // Projects feature (Git integration)\n    editorTheme: {\n        projects: {\n            enabled: true,\n            workflow: {\n                mode: \"$NODERED_PROJECTS_WORKFLOW_MODE\"\n            }\n        }\n    },\nSETTINGS_EOF\n    fi\n\n    # Close settings object\n    cat >> \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\n\n    // Function settings\n    functionGlobalContext: {\n        // Enable global context\n    },\n\n    // Export for http nodes\n    exportGlobalContextKeys: false,\n\n    // Dashboard path\n    ui: { path: \"/ui\" }\n}\nSETTINGS_EOF\n\n    chmod 644 \"$SETTINGS_FILE\"\n}\n\ninitialize_nodered() {\n    # Ensure credential secret exists\n    ensure_credential_secret\n\n    # Generate settings.js\n    generate_settings_js\n\n    # Install custom nodes (also handles redis context storage)\n    install_custom_nodes\n}\n\nreconfigure_nodered() {\n    # Load current config\n    load_config\n\n    # Run wizard\n    prompt_for_config\n\n    # Save new config\n    save_config\n\n    # Reinitialize\n    initialize_nodered\n\n    echo \"\"\n    gum style --foreground 46 \"âœ… Reconfiguration complete!\"\n    echo \"\"\n    gum style --foreground 245 \"Restart services to apply changes:\"\n    echo \"  flox services restart\"\n    echo \"\"\n}\n\n# === MAIN SETUP ===\n\nmain() {\n    # Load or set config\n    load_config\n\n    if check_first_run; then\n        # First run - show welcome and run wizard\n        gum style --border double --padding \"1 2\" --border-foreground 117 \"\n\n\n        ðŸš€ Welcome to Node-RED!\n\n        Node-RED is a low-code programming platform for\n        event-driven applications, IoT, and workflow automation.\n\n\n        \"\n\n        prompt_for_config\n        save_config\n        initialize_nodered\n    else\n        # Subsequent run - load config and initialize\n        ensure_credential_secret\n        generate_settings_js\n    fi\n\n    # Display summary\n    gum style --border double --padding \"1 2\" --border-foreground 46 \"\n\n\n    âœ… Node-RED Environment Ready\n\n\n    \"\n\n    echo \"Port: $NODERED_PORT\"\n    echo \"URL: http://localhost:$NODERED_PORT\"\n    echo \"Dashboard: http://localhost:$NODERED_PORT/ui\"\n    echo \"\"\n\n    if [ \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\" ]; then\n        echo \"Admin Authentication: Enabled\"\n        echo \"  Username: $NODERED_ADMIN_USER\"\n        echo \"  Password: (set)\"\n    else\n        gum style --foreground 208 \"âš ï¸  Admin Authentication: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Context Storage: $NODERED_CONTEXT_STORAGE\"\n\n    if [ \"$NODERED_PROJECTS_ENABLED\" = \"true\" ]; then\n        echo \"Projects: Enabled ($NODERED_PROJECTS_WORKFLOW_MODE mode)\"\n    else\n        echo \"Projects: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox activate -s        Start Node-RED services\"\n    echo \"  nodered-info            Show configuration\"\n    echo \"  nodered-reconfigure     Reconfigure environment\"\n    echo \"  nodered-hash-password   Generate bcrypt password hash\"\n    echo \"\"\n}\n\n# Execute main\nmain\n"
    },
    "profile": {
      "bash": "redis-info() {\n    echo \"Redis (Headless Mode) - Configuration\"\n    echo \"\"\n    echo \"Connection:\"\n    echo \"  Host: ${REDIS_HOST}:${REDIS_PORT}\"\n    if [ -n \"$REDIS_PASSWORD\" ]; then\n        echo \"  Password: ***\"\n    else\n        echo \"  Password: (none)\"\n    fi\n    echo \"  Protected mode: ${REDIS_PROTECTED_MODE}\"\n    echo \"\"\n    echo \"Memory:\"\n    echo \"  Max memory: ${REDIS_MAXMEMORY}\"\n    echo \"  Eviction policy: ${REDIS_MAXMEMORY_POLICY}\"\n    echo \"  Eviction samples: ${REDIS_MAXMEMORY_SAMPLES}\"\n    echo \"\"\n    echo \"Persistence (RDB):\"\n    echo \"  Enabled: ${REDIS_SAVE_RDB}\"\n    if [ \"$REDIS_SAVE_RDB\" = \"yes\" ]; then\n        echo \"  Save after 900s if ${REDIS_SAVE_900}+ changes\"\n        echo \"  Save after 300s if ${REDIS_SAVE_300}+ changes\"\n        echo \"  Save after 60s if ${REDIS_SAVE_60}+ changes\"\n        echo \"  Compression: ${REDIS_RDB_COMPRESSION}\"\n        echo \"  Checksum: ${REDIS_RDB_CHECKSUM}\"\n    fi\n    echo \"\"\n    echo \"Persistence (AOF):\"\n    echo \"  Enabled: ${REDIS_APPENDONLY}\"\n    if [ \"$REDIS_APPENDONLY\" = \"yes\" ]; then\n        echo \"  Fsync policy: ${REDIS_APPENDFSYNC}\"\n        echo \"  Rewrite percentage: ${REDIS_AOF_REWRITE_PERCENTAGE}\"\n        echo \"  Rewrite min size: ${REDIS_AOF_REWRITE_MIN_SIZE}\"\n    fi\n    echo \"\"\n    echo \"Performance:\"\n    echo \"  Databases: ${REDIS_DATABASES}\"\n    echo \"  Max clients: ${REDIS_MAXCLIENTS}\"\n    echo \"  TCP backlog: ${REDIS_TCP_BACKLOG}\"\n    echo \"  Timeout: ${REDIS_TIMEOUT}s\"\n    echo \"  TCP keepalive: ${REDIS_TCP_KEEPALIVE}s\"\n    echo \"\"\n    echo \"Monitoring:\"\n    echo \"  Slow log threshold: ${REDIS_SLOWLOG_LOG_SLOWER_THAN}Î¼s\"\n    echo \"  Slow log max length: ${REDIS_SLOWLOG_MAX_LEN}\"\n    echo \"  Latency monitor threshold: ${REDIS_LATENCY_MONITOR_THRESHOLD}ms\"\n    echo \"\"\n    echo \"Data Directory: ${REDIS_DIR}\"\n    echo \"Config File: ${REDIS_CONF_FILE}\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  redis-cli                       Connect to Redis\"\n    echo \"  flox activate -s                Start Redis service\"\n    echo \"  flox services status            Check service status\"\n    echo \"  flox services logs redis        View service logs\"\n    echo \"  flox services restart redis     Restart with new settings\"\n}\nexport -f redis-info\n\nnodered-info() {\n    echo \"Node-RED Environment Configuration\"\n    echo \"\"\n    echo \"Server:\"\n    echo \"  URL: http://localhost:$NODERED_PORT\"\n    echo \"  Dashboard: http://localhost:$NODERED_PORT/ui\"\n    echo \"  Listen: $NODERED_HOST:$NODERED_PORT\"\n    echo \"\"\n\n    if [ \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\" ]; then\n        echo \"Authentication: Enabled\"\n        echo \"  Admin Username: $NODERED_ADMIN_USER\"\n        echo \"  Admin Password: (set)\"\n    else\n        echo \"âš ï¸  Authentication: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Context Storage: $NODERED_CONTEXT_STORAGE\"\n\n    if [ \"$NODERED_CONTEXT_STORAGE\" = \"redis\" ]; then\n        echo \"  Redis: $REDIS_HOST:$REDIS_PORT\"\n        echo \"  DB: $REDIS_DB\"\n    fi\n\n    echo \"\"\n    if [ \"$NODERED_PROJECTS_ENABLED\" = \"true\" ]; then\n        echo \"Projects: Enabled ($NODERED_PROJECTS_WORKFLOW_MODE mode)\"\n    else\n        echo \"Projects: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Paths:\"\n    echo \"  User Directory: $NODERED_DATA_DIR\"\n    echo \"  Settings: $NODERED_DATA_DIR/settings.js\"\n    echo \"  Credential Secret: $FLOX_ENV_CACHE/nodered-credential.key\"\n\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox services status              Check service status\"\n    echo \"  flox services logs nodered        View Node-RED logs\"\n    echo \"  flox services restart             Restart services\"\n    echo \"  nodered-reconfigure               Reconfigure environment\"\n    echo \"  nodered-hash-password             Generate password hash\"\n}\nexport -f nodered-info\n\nnodered-reconfigure() {\n    reconfigure_nodered\n}\nexport -f nodered-reconfigure\n\nnodered-hash-password() {\n    echo \"Generate bcrypt password hash for Node-RED:\"\n    echo \"\"\n    node-red-admin hash-pw\n}\nexport -f nodered-hash-password\n",
      "zsh": "redis-info() {\n    echo \"Redis (Headless Mode) - Configuration\"\n    echo \"\"\n    echo \"Connection:\"\n    echo \"  Host: ${REDIS_HOST}:${REDIS_PORT}\"\n    if [ -n \"$REDIS_PASSWORD\" ]; then\n        echo \"  Password: ***\"\n    else\n        echo \"  Password: (none)\"\n    fi\n    echo \"  Protected mode: ${REDIS_PROTECTED_MODE}\"\n    echo \"\"\n    echo \"Memory:\"\n    echo \"  Max memory: ${REDIS_MAXMEMORY}\"\n    echo \"  Eviction policy: ${REDIS_MAXMEMORY_POLICY}\"\n    echo \"  Eviction samples: ${REDIS_MAXMEMORY_SAMPLES}\"\n    echo \"\"\n    echo \"Persistence (RDB):\"\n    echo \"  Enabled: ${REDIS_SAVE_RDB}\"\n    if [ \"$REDIS_SAVE_RDB\" = \"yes\" ]; then\n        echo \"  Save after 900s if ${REDIS_SAVE_900}+ changes\"\n        echo \"  Save after 300s if ${REDIS_SAVE_300}+ changes\"\n        echo \"  Save after 60s if ${REDIS_SAVE_60}+ changes\"\n        echo \"  Compression: ${REDIS_RDB_COMPRESSION}\"\n        echo \"  Checksum: ${REDIS_RDB_CHECKSUM}\"\n    fi\n    echo \"\"\n    echo \"Persistence (AOF):\"\n    echo \"  Enabled: ${REDIS_APPENDONLY}\"\n    if [ \"$REDIS_APPENDONLY\" = \"yes\" ]; then\n        echo \"  Fsync policy: ${REDIS_APPENDFSYNC}\"\n        echo \"  Rewrite percentage: ${REDIS_AOF_REWRITE_PERCENTAGE}\"\n        echo \"  Rewrite min size: ${REDIS_AOF_REWRITE_MIN_SIZE}\"\n    fi\n    echo \"\"\n    echo \"Performance:\"\n    echo \"  Databases: ${REDIS_DATABASES}\"\n    echo \"  Max clients: ${REDIS_MAXCLIENTS}\"\n    echo \"  TCP backlog: ${REDIS_TCP_BACKLOG}\"\n    echo \"  Timeout: ${REDIS_TIMEOUT}s\"\n    echo \"  TCP keepalive: ${REDIS_TCP_KEEPALIVE}s\"\n    echo \"\"\n    echo \"Monitoring:\"\n    echo \"  Slow log threshold: ${REDIS_SLOWLOG_LOG_SLOWER_THAN}Î¼s\"\n    echo \"  Slow log max length: ${REDIS_SLOWLOG_MAX_LEN}\"\n    echo \"  Latency monitor threshold: ${REDIS_LATENCY_MONITOR_THRESHOLD}ms\"\n    echo \"\"\n    echo \"Data Directory: ${REDIS_DIR}\"\n    echo \"Config File: ${REDIS_CONF_FILE}\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  redis-cli                       Connect to Redis\"\n    echo \"  flox activate -s                Start Redis service\"\n    echo \"  flox services status            Check service status\"\n    echo \"  flox services logs redis        View service logs\"\n    echo \"  flox services restart redis     Restart with new settings\"\n}\n\nnodered-info() {\n    echo \"Node-RED Environment Configuration\"\n    echo \"\"\n    echo \"Server:\"\n    echo \"  URL: http://localhost:$NODERED_PORT\"\n    echo \"  Dashboard: http://localhost:$NODERED_PORT/ui\"\n    echo \"  Listen: $NODERED_HOST:$NODERED_PORT\"\n    echo \"\"\n\n    if [ \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\" ]; then\n        echo \"Authentication: Enabled\"\n        echo \"  Admin Username: $NODERED_ADMIN_USER\"\n        echo \"  Admin Password: (set)\"\n    else\n        echo \"âš ï¸  Authentication: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Context Storage: $NODERED_CONTEXT_STORAGE\"\n\n    if [ \"$NODERED_CONTEXT_STORAGE\" = \"redis\" ]; then\n        echo \"  Redis: $REDIS_HOST:$REDIS_PORT\"\n        echo \"  DB: $REDIS_DB\"\n    fi\n\n    echo \"\"\n    if [ \"$NODERED_PROJECTS_ENABLED\" = \"true\" ]; then\n        echo \"Projects: Enabled ($NODERED_PROJECTS_WORKFLOW_MODE mode)\"\n    else\n        echo \"Projects: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Paths:\"\n    echo \"  User Directory: $NODERED_DATA_DIR\"\n    echo \"  Settings: $NODERED_DATA_DIR/settings.js\"\n    echo \"  Credential Secret: $FLOX_ENV_CACHE/nodered-credential.key\"\n\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox services status              Check service status\"\n    echo \"  flox services logs nodered        View Node-RED logs\"\n    echo \"  flox services restart             Restart services\"\n}\n\nnodered-reconfigure() {\n    reconfigure_nodered\n}\n\nnodered-hash-password() {\n    echo \"Generate bcrypt password hash for Node-RED:\"\n    echo \"\"\n    node-red-admin hash-pw\n}\n",
      "fish": "function redis-info\n    echo \"Redis (Headless Mode) - Configuration\"\n    echo \"\"\n    echo \"Connection:\"\n    echo \"  Host: $REDIS_HOST:$REDIS_PORT\"\n    if test -n \"$REDIS_PASSWORD\"\n        echo \"  Password: ***\"\n    else\n        echo \"  Password: (none)\"\n    end\n    echo \"  Protected mode: $REDIS_PROTECTED_MODE\"\n    echo \"\"\n    echo \"Memory:\"\n    echo \"  Max memory: $REDIS_MAXMEMORY\"\n    echo \"  Eviction policy: $REDIS_MAXMEMORY_POLICY\"\n    echo \"  Eviction samples: $REDIS_MAXMEMORY_SAMPLES\"\n    echo \"\"\n    echo \"Persistence (RDB):\"\n    echo \"  Enabled: $REDIS_SAVE_RDB\"\n    if test \"$REDIS_SAVE_RDB\" = \"yes\"\n        echo \"  Save after 900s if $REDIS_SAVE_900+ changes\"\n        echo \"  Save after 300s if $REDIS_SAVE_300+ changes\"\n        echo \"  Save after 60s if $REDIS_SAVE_60+ changes\"\n        echo \"  Compression: $REDIS_RDB_COMPRESSION\"\n        echo \"  Checksum: $REDIS_RDB_CHECKSUM\"\n    end\n    echo \"\"\n    echo \"Persistence (AOF):\"\n    echo \"  Enabled: $REDIS_APPENDONLY\"\n    if test \"$REDIS_APPENDONLY\" = \"yes\"\n        echo \"  Fsync policy: $REDIS_APPENDFSYNC\"\n        echo \"  Rewrite percentage: $REDIS_AOF_REWRITE_PERCENTAGE\"\n        echo \"  Rewrite min size: $REDIS_AOF_REWRITE_MIN_SIZE\"\n    end\n    echo \"\"\n    echo \"Performance:\"\n    echo \"  Databases: $REDIS_DATABASES\"\n    echo \"  Max clients: $REDIS_MAXCLIENTS\"\n    echo \"  TCP backlog: $REDIS_TCP_BACKLOG\"\n    echo \"  Timeout: $REDIS_TIMEOUT\"s\n    echo \"  TCP keepalive: $REDIS_TCP_KEEPALIVE\"s\n    echo \"\"\n    echo \"Monitoring:\"\n    echo \"  Slow log threshold: $REDIS_SLOWLOG_LOG_SLOWER_THAN\"Î¼s\n    echo \"  Slow log max length: $REDIS_SLOWLOG_MAX_LEN\"\n    echo \"  Latency monitor threshold: $REDIS_LATENCY_MONITOR_THRESHOLD\"ms\n    echo \"\"\n    echo \"Data Directory: $REDIS_DIR\"\n    echo \"Config File: $REDIS_CONF_FILE\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  redis-cli                       Connect to Redis\"\n    echo \"  flox activate -s                Start Redis service\"\n    echo \"  flox services status            Check service status\"\n    echo \"  flox services logs redis        View service logs\"\n    echo \"  flox services restart redis     Restart with new settings\"\nend\n\nfunction nodered-info\n    echo \"Node-RED Environment Configuration\"\n    echo \"\"\n    echo \"Server:\"\n    echo \"  URL: http://localhost:$NODERED_PORT\"\n    echo \"  Dashboard: http://localhost:$NODERED_PORT/ui\"\n    echo \"  Listen: $NODERED_HOST:$NODERED_PORT\"\n    echo \"\"\n\n    if test \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\"\n        echo \"Authentication: Enabled\"\n        echo \"  Admin Username: $NODERED_ADMIN_USER\"\n        echo \"  Admin Password: (set)\"\n    else\n        echo \"âš ï¸  Authentication: Disabled\"\n    end\n\n    echo \"\"\n    echo \"Context Storage: $NODERED_CONTEXT_STORAGE\"\n\n    if test \"$NODERED_CONTEXT_STORAGE\" = \"redis\"\n        echo \"  Redis: $REDIS_HOST:$REDIS_PORT\"\n        echo \"  DB: $REDIS_DB\"\n    end\n\n    echo \"\"\n    if test \"$NODERED_PROJECTS_ENABLED\" = \"true\"\n        echo \"Projects: Enabled ($NODERED_PROJECTS_WORKFLOW_MODE mode)\"\n    else\n        echo \"Projects: Disabled\"\n    end\n\n    echo \"\"\n    echo \"Paths:\"\n    echo \"  User Directory: $NODERED_DATA_DIR\"\n    echo \"  Settings: $NODERED_DATA_DIR/settings.js\"\n    echo \"  Credential Secret: $FLOX_ENV_CACHE/nodered-credential.key\"\n\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox services status              Check service status\"\n    echo \"  flox services logs nodered        View Node-RED logs\"\n    echo \"  flox services restart             Restart services\"\nend\n\nfunction nodered-reconfigure\n    reconfigure_nodered\nend\n\nfunction nodered-hash-password\n    echo \"Generate bcrypt password hash for Node-RED:\"\n    echo \"\"\n    node-red-admin hash-pw\nend\n"
    },
    "options": {
      "systems": [
        "aarch64-darwin",
        "aarch64-linux",
        "x86_64-darwin",
        "x86_64-linux"
      ]
    },
    "services": {
      "nodered": {
        "command": "# Ensure credential secret exists\nif [ -z \"$NODERED_CREDENTIAL_SECRET\" ]; then\n    echo \"ERROR: NODERED_CREDENTIAL_SECRET not set\"\n    return 1\nfi\n\n# Ensure settings.js exists\nif [ ! -f \"$NODERED_DATA_DIR/settings.js\" ]; then\n    echo \"ERROR: settings.js not found in $NODERED_DATA_DIR\"\n    return 1\nfi\n\n# Export credential secret\nexport NODERED_CREDENTIAL_SECRET\n\n# Start Node-RED\nexec node-red \\\n  --port \"$NODERED_PORT\" \\\n  --userDir \"$NODERED_DATA_DIR\" \\\n  --settings \"$NODERED_DATA_DIR/settings.js\"\n"
      },
      "redis": {
        "command": "redis-server $REDIS_CONF_FILE"
      }
    }
  },
  "packages": [
    {
      "attr_path": "gum",
      "broken": false,
      "derivation": "/nix/store/675k33a7fnqda5p3rn5qjc33ivqrh68q-gum-0.17.0.drv",
      "description": "Tasty Bubble Gum for your shell",
      "install_id": "gum",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "gum-0.17.0",
      "pname": "gum",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:08:16.755997Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.17.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/g384sncfvkxfpiswcg01hk6r3z0681ix-gum-0.17.0"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "gum",
      "broken": false,
      "derivation": "/nix/store/x4gr782ka05mb2gwd2hxlnwrcxxj8m1m-gum-0.17.0.drv",
      "description": "Tasty Bubble Gum for your shell",
      "install_id": "gum",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "gum-0.17.0",
      "pname": "gum",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:18:28.225289Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.17.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/vkh7n5a7nhxlv4zzxs1anaqcbpsaakdw-gum-0.17.0"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "gum",
      "broken": false,
      "derivation": "/nix/store/sz3las4dhlb9xrz4fgw4l5zkss3s3afd-gum-0.17.0.drv",
      "description": "Tasty Bubble Gum for your shell",
      "install_id": "gum",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "gum-0.17.0",
      "pname": "gum",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:29:22.646362Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.17.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/j459dmmrrfzia8zgpykkr4fsv0ydrsvg-gum-0.17.0"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "gum",
      "broken": false,
      "derivation": "/nix/store/m4rq0l39b36z03rq5sb8y5zsid4y09ad-gum-0.17.0.drv",
      "description": "Tasty Bubble Gum for your shell",
      "install_id": "gum",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "gum-0.17.0",
      "pname": "gum",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T03:00:56.654223Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.17.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/bqaqgkwjxdq6vxq210v9893ibmag515f-gum-0.17.0"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "node-red",
      "broken": false,
      "derivation": "/nix/store/1gjihcsypcxjr1c323kh7zs2vmsg50cw-node-red-4.1.1.drv",
      "description": "Low-code programming for event-driven applications",
      "install_id": "node-red",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "node-red-4.1.1",
      "pname": "node-red",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:08:37.187522Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "4.1.1",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/kagq8vlihm9wypglslxsfszmawlazwxd-node-red-4.1.1"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "node-red",
      "broken": false,
      "derivation": "/nix/store/qfaamips3v41h3msvxlipmxcvi7g46am-node-red-4.1.1.drv",
      "description": "Low-code programming for event-driven applications",
      "install_id": "node-red",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "node-red-4.1.1",
      "pname": "node-red",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:19:01.609876Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "4.1.1",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/cl85k1dfyj2rcsfdpvy0i15m86l10lna-node-red-4.1.1"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "node-red",
      "broken": false,
      "derivation": "/nix/store/6bd73hckmm0zs0gf48s0z87q8g515j6d-node-red-4.1.1.drv",
      "description": "Low-code programming for event-driven applications",
      "install_id": "node-red",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "node-red-4.1.1",
      "pname": "node-red",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:29:42.883754Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "4.1.1",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/lnz3p719j5rcnhgb5f92y3g278s4bh6h-node-red-4.1.1"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "node-red",
      "broken": false,
      "derivation": "/nix/store/y0b6n406wavq0hm40h2ci3kdm0mmv0rh-node-red-4.1.1.drv",
      "description": "Low-code programming for event-driven applications",
      "install_id": "node-red",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "node-red-4.1.1",
      "pname": "node-red",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T03:01:33.787040Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "4.1.1",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/42jizbv7vkm4yfhc959c9wcm4zqd6gmz-node-red-4.1.1"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "nodejs",
      "broken": false,
      "derivation": "/nix/store/zwv4yyk5jkgsby5flqgnahh3lvlz3hk6-nodejs-22.20.0.drv",
      "description": "Event-driven I/O framework for the V8 JavaScript engine",
      "install_id": "nodejs",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "nodejs-22.20.0",
      "pname": "nodejs",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:08:37.988068Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "22.20.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "dev": "/nix/store/8ckn8ghxqbnd5z4c7ijsq7yps3ad1inj-nodejs-22.20.0-dev",
        "libv8": "/nix/store/nxjx4dsqfc55mzk7is53f7qsb1lsqq4j-nodejs-22.20.0-libv8",
        "out": "/nix/store/4whakvkkpcgbdzxl1y32vq7rb73k4faq-nodejs-22.20.0"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "nodejs",
      "broken": false,
      "derivation": "/nix/store/4rx0flnp5k575882fhcs7ahpzjjgkbvr-nodejs-22.20.0.drv",
      "description": "Event-driven I/O framework for the V8 JavaScript engine",
      "install_id": "nodejs",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "nodejs-22.20.0",
      "pname": "nodejs",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:19:02.847811Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "22.20.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "dev": "/nix/store/0vkqirb963hm21wh13y3zd23dmlbfk61-nodejs-22.20.0-dev",
        "libv8": "/nix/store/8dijv5z9djsjckbp86vbm0jykwscbj53-nodejs-22.20.0-libv8",
        "out": "/nix/store/82qylyr9s3i07hwvab44cbi0w4dc74ix-nodejs-22.20.0"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "nodejs",
      "broken": false,
      "derivation": "/nix/store/bf39zy93zbigcwjvq44z2r3s4wlxh1zc-nodejs-22.20.0.drv",
      "description": "Event-driven I/O framework for the V8 JavaScript engine",
      "install_id": "nodejs",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "nodejs-22.20.0",
      "pname": "nodejs",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:29:43.676392Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "22.20.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "dev": "/nix/store/8087iiqh20y83h0pjrq7dz3c3drsk737-nodejs-22.20.0-dev",
        "libv8": "/nix/store/q3idpy9brlwa5zn45jfj48xhrhni7js6-nodejs-22.20.0-libv8",
        "out": "/nix/store/mh8lhrbhxnpxflx984l48c9hjwbpab8v-nodejs-22.20.0"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "nodejs",
      "broken": false,
      "derivation": "/nix/store/17l9a0z195ympiszhw3ah4piacgzhni2-nodejs-22.20.0.drv",
      "description": "Event-driven I/O framework for the V8 JavaScript engine",
      "install_id": "nodejs",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "nodejs-22.20.0",
      "pname": "nodejs",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T03:01:34.947342Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "22.20.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "dev": "/nix/store/x62pydw9kpd88m4986kyc02q8x3ipp3j-nodejs-22.20.0-dev",
        "libv8": "/nix/store/hx91x0nj1h9jigh5sm08mvd4cas3aw48-nodejs-22.20.0-libv8",
        "out": "/nix/store/nvf9kaarb9kqqdbygl9cbzhli1y8yjik-nodejs-22.20.0"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "redis",
      "broken": false,
      "derivation": "/nix/store/40813pbibs4x5dvxs58gzv8132ijr1sn-redis-8.2.2.drv",
      "description": "Open source, advanced key-value store",
      "install_id": "redis",
      "license": "AGPL-3.0-only",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "redis-8.2.2",
      "pname": "redis",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:09:38.538876Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "8.2.2",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/098ag56hpj05yi1a0lc5h3dabbjcak47-redis-8.2.2"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "redis",
      "broken": false,
      "derivation": "/nix/store/vdjv3ma7n6fgdyi1jxqih23c80bry679-redis-8.2.2.drv",
      "description": "Open source, advanced key-value store",
      "install_id": "redis",
      "license": "AGPL-3.0-only",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "redis-8.2.2",
      "pname": "redis",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:20:26.914059Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "8.2.2",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/76fkv3lj81582lxgcpz2c5qai4dbsy7s-redis-8.2.2"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "redis",
      "broken": false,
      "derivation": "/nix/store/iad8zh6gvaxi99yqc7kn5arnl6fy75p3-redis-8.2.2.drv",
      "description": "Open source, advanced key-value store",
      "install_id": "redis",
      "license": "AGPL-3.0-only",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "redis-8.2.2",
      "pname": "redis",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:30:42.731222Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "8.2.2",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/jlfys7wmr257l75dsz4x0va0wp6agmyr-redis-8.2.2"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "redis",
      "broken": false,
      "derivation": "/nix/store/csnzbhfjmkc934l5jbqx3653hfi8sxbi-redis-8.2.2.drv",
      "description": "Open source, advanced key-value store",
      "install_id": "redis",
      "license": "AGPL-3.0-only",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "redis-8.2.2",
      "pname": "redis",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T03:02:59.796166Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "8.2.2",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/cmxzhc1q1dw301l5iwbjn3kx96vpj5am-redis-8.2.2"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    }
  ],
  "compose": {
    "composer": {
      "version": 1,
      "install": {
        "gum": {
          "pkg-path": "gum"
        },
        "node-red": {
          "pkg-path": "node-red"
        },
        "nodejs": {
          "pkg-path": "nodejs"
        }
      },
      "vars": {
        "NODERED_CONFIG_DIR": "$FLOX_ENV_CACHE/nodered-config",
        "NODERED_DATA_DIR": "$FLOX_ENV_CACHE/nodered-data",
        "NODERED_LOG_DIR": "$FLOX_ENV_CACHE/nodered-logs"
      },
      "hook": {
        "on-activate": "# Create required directories\nmkdir -p \"$FLOX_ENV_CACHE/nodered-config\"\nmkdir -p \"$FLOX_ENV_CACHE/nodered-data\"\nmkdir -p \"$FLOX_ENV_CACHE/nodered-logs\"\n\n# === CONFIGURATION FILES ===\nexport CONFIG_FILE=\"$FLOX_ENV_CACHE/nodered.config\"\nexport CREDENTIAL_SECRET_FILE=\"$FLOX_ENV_CACHE/nodered-credential.key\"\nexport SETTINGS_FILE=\"$NODERED_DATA_DIR/settings.js\"\n\n# === DEFAULT VALUES ===\nexport DEFAULT_PORT=\"1880\"\nexport DEFAULT_HOST=\"0.0.0.0\"\nexport DEFAULT_ADMIN_USER=\"admin\"\nexport DEFAULT_ADMIN_PASSWORD=\"admin\"\nexport DEFAULT_CONTEXT_STORAGE=\"memory\"\nexport DEFAULT_PROJECTS_ENABLED=\"true\"\nexport DEFAULT_WORKFLOW_MODE=\"manual\"\n\n# === HELPER FUNCTIONS ===\n\ncheck_first_run() {\n    if [[ ! -f \"$CONFIG_FILE\" ]]; then\n        return 0  # True, first run\n    else\n        return 1  # False, not first run\n    fi\n}\n\nload_config() {\n    if [[ -f \"$CONFIG_FILE\" ]]; then\n        source \"$CONFIG_FILE\"\n    else\n        # Set defaults if no config\n        export NODERED_PORT=\"$DEFAULT_PORT\"\n        export NODERED_HOST=\"$DEFAULT_HOST\"\n        export NODERED_ADMIN_AUTH_ENABLED=\"true\"\n        export NODERED_ADMIN_USER=\"$DEFAULT_ADMIN_USER\"\n        export NODERED_ADMIN_PASSWORD=\"$DEFAULT_ADMIN_PASSWORD\"\n        export NODERED_HTTP_AUTH_ENABLED=\"false\"\n        export NODERED_CONTEXT_STORAGE=\"$DEFAULT_CONTEXT_STORAGE\"\n        export NODERED_CUSTOM_NODES=\"minimal\"\n        export NODERED_PROJECTS_ENABLED=\"$DEFAULT_PROJECTS_ENABLED\"\n        export NODERED_PROJECTS_WORKFLOW_MODE=\"$DEFAULT_WORKFLOW_MODE\"\n    fi\n}\n\nsave_config() {\n    mkdir -p \"$(dirname \"$CONFIG_FILE\")\"\n    cat > \"$CONFIG_FILE\" << EOF\n# Node-RED configuration - Generated on $(date)\nexport NODERED_PORT=\"$NODERED_PORT\"\nexport NODERED_HOST=\"$NODERED_HOST\"\nexport NODERED_ADMIN_AUTH_ENABLED=\"$NODERED_ADMIN_AUTH_ENABLED\"\nexport NODERED_ADMIN_USER=\"$NODERED_ADMIN_USER\"\nexport NODERED_ADMIN_PASSWORD=\"$NODERED_ADMIN_PASSWORD\"\nexport NODERED_HTTP_AUTH_ENABLED=\"$NODERED_HTTP_AUTH_ENABLED\"\nexport NODERED_HTTP_USER=\"$NODERED_HTTP_USER\"\nexport NODERED_HTTP_PASSWORD=\"$NODERED_HTTP_PASSWORD\"\nexport NODERED_CONTEXT_STORAGE=\"$NODERED_CONTEXT_STORAGE\"\nexport REDIS_HOST=\"$REDIS_HOST\"\nexport REDIS_PORT=\"$REDIS_PORT\"\nexport REDIS_DB=\"$REDIS_DB\"\nexport REDIS_PASSWORD=\"$REDIS_PASSWORD\"\nexport NODERED_CUSTOM_NODES=\"$NODERED_CUSTOM_NODES\"\nexport NODERED_CUSTOM_NODES_LIST=\"$NODERED_CUSTOM_NODES_LIST\"\nexport NODERED_PROJECTS_ENABLED=\"$NODERED_PROJECTS_ENABLED\"\nexport NODERED_PROJECTS_WORKFLOW_MODE=\"$NODERED_PROJECTS_WORKFLOW_MODE\"\n\n## BEGIN ACTIVATION HOOK ##\n$(declare -f check_first_run)\n$(declare -f load_config)\n$(declare -f save_config)\n$(declare -f ensure_credential_secret)\n$(declare -f prompt_for_config)\n$(declare -f install_custom_nodes)\n$(declare -f generate_settings_js)\n$(declare -f initialize_nodered)\n$(declare -f reconfigure_nodered)\n$(declare -f main)\n## END ACTIVATION HOOK ##\nEOF\n    chmod 644 \"$CONFIG_FILE\"\n}\n\nensure_credential_secret() {\n    if [ -n \"$NODERED_CREDENTIAL_SECRET\" ]; then\n        # User provided their own secret\n        export NODERED_CREDENTIAL_SECRET\n    elif [ -f \"$CREDENTIAL_SECRET_FILE\" ]; then\n        # Load existing secret\n        export NODERED_CREDENTIAL_SECRET=$(cat \"$CREDENTIAL_SECRET_FILE\")\n    else\n        # Generate new secret\n        export NODERED_CREDENTIAL_SECRET=$(openssl rand -hex 32)\n        echo \"$NODERED_CREDENTIAL_SECRET\" > \"$CREDENTIAL_SECRET_FILE\"\n        chmod 600 \"$CREDENTIAL_SECRET_FILE\"\n        echo \"\"\n        gum style --foreground 208 \"âš ï¸  Credential secret generated and saved to:\"\n        echo \"   $CREDENTIAL_SECRET_FILE\"\n        echo \"\"\n        gum style --foreground 196 --bold \"ðŸ”’ CRITICAL: Back up this file!\"\n        echo \"   Without it, flow credentials are unrecoverable.\"\n        echo \"\"\n    fi\n}\n\nprompt_for_config() {\n    gum style --border double --padding \"1 2\" --border-foreground 212 \"\n    ðŸŽ¯ Node-RED Configuration Wizard\n\n    Configure your Node-RED workflow automation environment\n    \"\n\n    # Server configuration\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    gum style --foreground 117 \"ðŸ“¡ Server Configuration\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    echo \"\"\n\n    NODERED_PORT=$(gum input --placeholder \"$DEFAULT_PORT\" --value \"$NODERED_PORT\" --prompt \"Port: \")\n    NODERED_HOST=$(gum input --placeholder \"$DEFAULT_HOST\" --value \"$NODERED_HOST\" --prompt \"Listen address: \")\n\n    # Security configuration\n    echo \"\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    gum style --foreground 117 \"ðŸ” Security Configuration\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    echo \"\"\n\n    if gum confirm \"Enable admin authentication?\" --default=true --affirmative=\"Yes\" --negative=\"No\"; then\n        export NODERED_ADMIN_AUTH_ENABLED=\"true\"\n        NODERED_ADMIN_USER=$(gum input --placeholder \"$DEFAULT_ADMIN_USER\" --value \"$NODERED_ADMIN_USER\" --prompt \"Admin username: \")\n        NODERED_ADMIN_PASSWORD=$(gum input --placeholder \"$DEFAULT_ADMIN_PASSWORD\" --value \"$NODERED_ADMIN_PASSWORD\" --prompt \"Admin password: \" --password)\n    else\n        export NODERED_ADMIN_AUTH_ENABLED=\"false\"\n        gum style --foreground 208 \"âš ï¸  Admin authentication disabled\"\n    fi\n\n    echo \"\"\n    if gum confirm \"Enable HTTP node authentication?\" --default=false --affirmative=\"Yes\" --negative=\"No\"; then\n        export NODERED_HTTP_AUTH_ENABLED=\"true\"\n        NODERED_HTTP_USER=$(gum input --placeholder \"http-user\" --prompt \"HTTP username: \")\n        NODERED_HTTP_PASSWORD=$(gum input --placeholder \"password\" --prompt \"HTTP password: \" --password)\n    else\n        export NODERED_HTTP_AUTH_ENABLED=\"false\"\n    fi\n\n    # Context storage\n    echo \"\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    gum style --foreground 117 \"ðŸ’¾ Context Storage\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    echo \"\"\n    gum style --foreground 245 \"Memory:    Fast, not persistent\"\n    gum style --foreground 245 \"File:      Persistent, no external deps\"\n    gum style --foreground 245 \"Redis:     HA/clustering, persistent\"\n    echo \"\"\n\n    STORAGE_CHOICE=$(gum choose --header \"Select context storage:\" \"Memory\" \"File\" \"Redis\")\n\n    case \"$STORAGE_CHOICE\" in\n        \"Memory\")\n            export NODERED_CONTEXT_STORAGE=\"memory\"\n            ;;\n        \"File\")\n            export NODERED_CONTEXT_STORAGE=\"file\"\n            ;;\n        \"Redis\")\n            export NODERED_CONTEXT_STORAGE=\"redis\"\n            echo \"\"\n            REDIS_HOST=$(gum input --placeholder \"127.0.0.1\" --value \"${REDIS_HOST:-127.0.0.1}\" --prompt \"Redis host: \")\n            REDIS_PORT=$(gum input --placeholder \"16379\" --value \"${REDIS_PORT:-16379}\" --prompt \"Redis port: \")\n            REDIS_DB=$(gum input --placeholder \"0\" --value \"${REDIS_DB:-0}\" --prompt \"Redis DB: \")\n            REDIS_PASSWORD=$(gum input --placeholder \"(optional)\" --value \"${REDIS_PASSWORD:-}\" --prompt \"Redis password: \" --password)\n            ;;\n    esac\n\n    # Custom nodes\n    echo \"\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    gum style --foreground 117 \"ðŸ“¦ Custom Nodes Installation\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    echo \"\"\n    gum style --foreground 245 \"Minimal: dashboard only\"\n    gum style --foreground 245 \"Common:  dashboard + email + influxdb + mysql + postgres\"\n    gum style --foreground 245 \"Custom:  specify your own package list\"\n    echo \"\"\n\n    NODES_CHOICE=$(gum choose --header \"Select custom nodes:\" \"Minimal\" \"Common\" \"Custom\")\n\n    case \"$NODES_CHOICE\" in\n        \"Minimal\")\n            export NODERED_CUSTOM_NODES=\"minimal\"\n            ;;\n        \"Common\")\n            export NODERED_CUSTOM_NODES=\"common\"\n            ;;\n        \"Custom\")\n            export NODERED_CUSTOM_NODES=\"custom\"\n            echo \"\"\n            gum style --foreground 245 \"Enter npm package names (space-separated):\"\n            NODERED_CUSTOM_NODES_LIST=$(gum input --placeholder \"node-red-dashboard node-red-node-email\" --prompt \"Packages: \")\n            ;;\n    esac\n\n    # Projects feature\n    echo \"\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    gum style --foreground 117 \"ðŸ”§ Projects Feature (Git Integration)\"\n    gum style --foreground 117 \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\"\n    echo \"\"\n    gum style --foreground 245 \"Projects enable Git version control within the Node-RED editor\"\n    echo \"\"\n\n    if gum confirm \"Enable projects feature?\" --default=true --affirmative=\"Yes\" --negative=\"No\"; then\n        export NODERED_PROJECTS_ENABLED=\"true\"\n        echo \"\"\n        gum style --foreground 245 \"Manual: Commit/push manually (recommended for learning)\"\n        gum style --foreground 245 \"Auto:   Auto-commit on deploy\"\n        echo \"\"\n        WORKFLOW_CHOICE=$(gum choose --header \"Workflow mode:\" \"Manual (recommended)\" \"Auto\")\n        case \"$WORKFLOW_CHOICE\" in\n            \"Manual (recommended)\")\n                export NODERED_PROJECTS_WORKFLOW_MODE=\"manual\"\n                ;;\n            \"Auto\")\n                export NODERED_PROJECTS_WORKFLOW_MODE=\"auto\"\n                ;;\n        esac\n    else\n        export NODERED_PROJECTS_ENABLED=\"false\"\n    fi\n\n    echo \"\"\n    gum style --foreground 46 \"âœ… Configuration complete!\"\n    echo \"\"\n}\n\ninstall_custom_nodes() {\n    local NODES_INSTALLED_FLAG=\"$NODERED_DATA_DIR/.nodes_installed_$NODERED_CUSTOM_NODES\"\n\n    # Check if already installed\n    if [ -f \"$NODES_INSTALLED_FLAG\" ]; then\n        return 0\n    fi\n\n    # Determine package list\n    local PACKAGES=\"\"\n    case \"$NODERED_CUSTOM_NODES\" in\n        \"minimal\")\n            PACKAGES=\"@flowfuse/node-red-dashboard\"\n            ;;\n        \"common\")\n            PACKAGES=\"@flowfuse/node-red-dashboard node-red-node-email node-red-contrib-influxdb node-red-node-mysql node-red-node-postgres\"\n            ;;\n        \"custom\")\n            PACKAGES=\"$NODERED_CUSTOM_NODES_LIST\"\n            ;;\n    esac\n\n    # Check if we need to install anything (custom nodes OR redis context)\n    local NEEDS_INSTALL=false\n    if [ -n \"$PACKAGES\" ]; then\n        NEEDS_INSTALL=true\n    fi\n    if [ \"$NODERED_CONTEXT_STORAGE\" = \"redis\" ]; then\n        NEEDS_INSTALL=true\n    fi\n\n    if [ \"$NEEDS_INSTALL\" = \"false\" ]; then\n        return 0\n    fi\n\n    echo \"\"\n    gum style --foreground 117 \"ðŸ“¦ Installing custom nodes...\"\n    echo \"\"\n\n    # Start Node-RED briefly to initialize userDir\n    timeout 10 node-red --userDir \"$NODERED_DATA_DIR\" --settings \"$SETTINGS_FILE\" &>/dev/null || true\n\n    # Wait for package.json to exist\n    for i in {1..30}; do\n        if [ -f \"$NODERED_DATA_DIR/package.json\" ]; then\n            break\n        fi\n        sleep 0.5\n    done\n\n    if [ ! -f \"$NODERED_DATA_DIR/package.json\" ]; then\n        gum style --foreground 196 \"âš ï¸  Warning: Could not initialize Node-RED userDir\"\n        gum style --foreground 245 \"   Custom nodes will need to be installed manually\"\n        return 1\n    fi\n\n    # Install nodes\n    cd \"$NODERED_DATA_DIR\"\n\n    # Install Redis context storage if needed\n    if [ \"$NODERED_CONTEXT_STORAGE\" = \"redis\" ]; then\n        echo \"  Installing node-red-context-redis...\"\n        npm install --silent --no-audit --no-fund node-red-context-redis 2>&1 | grep -v \"npm WARN\" || true\n    fi\n\n    # Install custom nodes\n    for pkg in $PACKAGES; do\n        echo \"  Installing $pkg...\"\n        npm install --silent --no-audit --no-fund \"$pkg\" 2>&1 | grep -v \"npm WARN\" || true\n    done\n\n    # Mark as installed\n    touch \"$NODES_INSTALLED_FLAG\"\n\n    echo \"\"\n    gum style --foreground 46 \"âœ… Custom nodes installed successfully\"\n    echo \"\"\n}\n\ngenerate_settings_js() {\n    # Generate bcrypt hash for admin password if auth enabled\n    local ADMIN_PASSWORD_HASH=\"\"\n    if [ \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\" ]; then\n        # Use node-red-admin to hash password\n        ADMIN_PASSWORD_HASH=$(echo \"$NODERED_ADMIN_PASSWORD\" | node-red-admin hash-pw 2>/dev/null | tail -1)\n    fi\n\n    # Generate bcrypt hash for HTTP password if auth enabled\n    local HTTP_PASSWORD_HASH=\"\"\n    if [ \"$NODERED_HTTP_AUTH_ENABLED\" = \"true\" ]; then\n        HTTP_PASSWORD_HASH=$(echo \"$NODERED_HTTP_PASSWORD\" | node-red-admin hash-pw 2>/dev/null | tail -1)\n    fi\n\n    # Generate settings.js\n    cat > \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\nmodule.exports = {\n    // Server settings\n    uiPort: process.env.NODERED_PORT || 1880,\n    uiHost: process.env.NODERED_HOST || \"0.0.0.0\",\n\n    // User directory\n    userDir: process.env.NODERED_DATA_DIR,\n\n    // Flow file\n    flowFile: process.env.NODERED_FLOW_FILE || \"flows.json\",\n\n    // Credential secret\n    credentialSecret: process.env.NODERED_CREDENTIAL_SECRET,\nSETTINGS_EOF\n\n    # Add admin authentication if enabled\n    if [ \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\" ]; then\n        cat >> \"$SETTINGS_FILE\" << SETTINGS_EOF\n\n    // Admin authentication\n    adminAuth: {\n        type: \"credentials\",\n        users: [{\n            username: \"$NODERED_ADMIN_USER\",\n            password: \"$ADMIN_PASSWORD_HASH\",\n            permissions: \"*\"\n        }]\n    },\nSETTINGS_EOF\n    fi\n\n    # Add HTTP node authentication if enabled\n    if [ \"$NODERED_HTTP_AUTH_ENABLED\" = \"true\" ]; then\n        cat >> \"$SETTINGS_FILE\" << SETTINGS_EOF\n\n    // HTTP node authentication\n    httpNodeAuth: {\n        user: \"$NODERED_HTTP_USER\",\n        pass: \"$HTTP_PASSWORD_HASH\"\n    },\nSETTINGS_EOF\n    fi\n\n    # Add context storage configuration\n    cat >> \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\n\n    // Context storage\n    contextStorage: {\nSETTINGS_EOF\n\n    case \"$NODERED_CONTEXT_STORAGE\" in\n        \"memory\")\n            cat >> \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\n        default: {\n            module: \"memory\"\n        }\nSETTINGS_EOF\n            ;;\n        \"file\")\n            cat >> \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\n        default: \"file\",\n        file: {\n            module: \"localfilesystem\"\n        }\nSETTINGS_EOF\n            ;;\n        \"redis\")\n            cat >> \"$SETTINGS_FILE\" << SETTINGS_EOF\n        default: \"redis\",\n        redis: {\n            module: require(\"node-red-context-redis\"),\n            config: {\n                host: \"$REDIS_HOST\",\n                port: $REDIS_PORT,\n                db: $REDIS_DB,\n                password: \"$REDIS_PASSWORD\",\n                prefix: \"nodered\"\n            }\n        }\nSETTINGS_EOF\n            ;;\n    esac\n\n    cat >> \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\n    },\n\n    // Logging\n    logging: {\n        console: {\n            level: \"info\",\n            metrics: false,\n            audit: false\n        }\n    },\nSETTINGS_EOF\n\n    # Add projects configuration\n    if [ \"$NODERED_PROJECTS_ENABLED\" = \"true\" ]; then\n        cat >> \"$SETTINGS_FILE\" << SETTINGS_EOF\n\n    // Projects feature (Git integration)\n    editorTheme: {\n        projects: {\n            enabled: true,\n            workflow: {\n                mode: \"$NODERED_PROJECTS_WORKFLOW_MODE\"\n            }\n        }\n    },\nSETTINGS_EOF\n    fi\n\n    # Close settings object\n    cat >> \"$SETTINGS_FILE\" << 'SETTINGS_EOF'\n\n    // Function settings\n    functionGlobalContext: {\n        // Enable global context\n    },\n\n    // Export for http nodes\n    exportGlobalContextKeys: false,\n\n    // Dashboard path\n    ui: { path: \"/ui\" }\n}\nSETTINGS_EOF\n\n    chmod 644 \"$SETTINGS_FILE\"\n}\n\ninitialize_nodered() {\n    # Ensure credential secret exists\n    ensure_credential_secret\n\n    # Generate settings.js\n    generate_settings_js\n\n    # Install custom nodes (also handles redis context storage)\n    install_custom_nodes\n}\n\nreconfigure_nodered() {\n    # Load current config\n    load_config\n\n    # Run wizard\n    prompt_for_config\n\n    # Save new config\n    save_config\n\n    # Reinitialize\n    initialize_nodered\n\n    echo \"\"\n    gum style --foreground 46 \"âœ… Reconfiguration complete!\"\n    echo \"\"\n    gum style --foreground 245 \"Restart services to apply changes:\"\n    echo \"  flox services restart\"\n    echo \"\"\n}\n\n# === MAIN SETUP ===\n\nmain() {\n    # Load or set config\n    load_config\n\n    if check_first_run; then\n        # First run - show welcome and run wizard\n        gum style --border double --padding \"1 2\" --border-foreground 117 \"\n\n\n        ðŸš€ Welcome to Node-RED!\n\n        Node-RED is a low-code programming platform for\n        event-driven applications, IoT, and workflow automation.\n\n\n        \"\n\n        prompt_for_config\n        save_config\n        initialize_nodered\n    else\n        # Subsequent run - load config and initialize\n        ensure_credential_secret\n        generate_settings_js\n    fi\n\n    # Display summary\n    gum style --border double --padding \"1 2\" --border-foreground 46 \"\n\n\n    âœ… Node-RED Environment Ready\n\n\n    \"\n\n    echo \"Port: $NODERED_PORT\"\n    echo \"URL: http://localhost:$NODERED_PORT\"\n    echo \"Dashboard: http://localhost:$NODERED_PORT/ui\"\n    echo \"\"\n\n    if [ \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\" ]; then\n        echo \"Admin Authentication: Enabled\"\n        echo \"  Username: $NODERED_ADMIN_USER\"\n        echo \"  Password: (set)\"\n    else\n        gum style --foreground 208 \"âš ï¸  Admin Authentication: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Context Storage: $NODERED_CONTEXT_STORAGE\"\n\n    if [ \"$NODERED_PROJECTS_ENABLED\" = \"true\" ]; then\n        echo \"Projects: Enabled ($NODERED_PROJECTS_WORKFLOW_MODE mode)\"\n    else\n        echo \"Projects: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox activate -s        Start Node-RED services\"\n    echo \"  nodered-info            Show configuration\"\n    echo \"  nodered-reconfigure     Reconfigure environment\"\n    echo \"  nodered-hash-password   Generate bcrypt password hash\"\n    echo \"\"\n}\n\n# Execute main\nmain\n"
      },
      "profile": {
        "bash": "nodered-info() {\n    echo \"Node-RED Environment Configuration\"\n    echo \"\"\n    echo \"Server:\"\n    echo \"  URL: http://localhost:$NODERED_PORT\"\n    echo \"  Dashboard: http://localhost:$NODERED_PORT/ui\"\n    echo \"  Listen: $NODERED_HOST:$NODERED_PORT\"\n    echo \"\"\n\n    if [ \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\" ]; then\n        echo \"Authentication: Enabled\"\n        echo \"  Admin Username: $NODERED_ADMIN_USER\"\n        echo \"  Admin Password: (set)\"\n    else\n        echo \"âš ï¸  Authentication: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Context Storage: $NODERED_CONTEXT_STORAGE\"\n\n    if [ \"$NODERED_CONTEXT_STORAGE\" = \"redis\" ]; then\n        echo \"  Redis: $REDIS_HOST:$REDIS_PORT\"\n        echo \"  DB: $REDIS_DB\"\n    fi\n\n    echo \"\"\n    if [ \"$NODERED_PROJECTS_ENABLED\" = \"true\" ]; then\n        echo \"Projects: Enabled ($NODERED_PROJECTS_WORKFLOW_MODE mode)\"\n    else\n        echo \"Projects: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Paths:\"\n    echo \"  User Directory: $NODERED_DATA_DIR\"\n    echo \"  Settings: $NODERED_DATA_DIR/settings.js\"\n    echo \"  Credential Secret: $FLOX_ENV_CACHE/nodered-credential.key\"\n\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox services status              Check service status\"\n    echo \"  flox services logs nodered        View Node-RED logs\"\n    echo \"  flox services restart             Restart services\"\n    echo \"  nodered-reconfigure               Reconfigure environment\"\n    echo \"  nodered-hash-password             Generate password hash\"\n}\nexport -f nodered-info\n\nnodered-reconfigure() {\n    reconfigure_nodered\n}\nexport -f nodered-reconfigure\n\nnodered-hash-password() {\n    echo \"Generate bcrypt password hash for Node-RED:\"\n    echo \"\"\n    node-red-admin hash-pw\n}\nexport -f nodered-hash-password\n",
        "zsh": "nodered-info() {\n    echo \"Node-RED Environment Configuration\"\n    echo \"\"\n    echo \"Server:\"\n    echo \"  URL: http://localhost:$NODERED_PORT\"\n    echo \"  Dashboard: http://localhost:$NODERED_PORT/ui\"\n    echo \"  Listen: $NODERED_HOST:$NODERED_PORT\"\n    echo \"\"\n\n    if [ \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\" ]; then\n        echo \"Authentication: Enabled\"\n        echo \"  Admin Username: $NODERED_ADMIN_USER\"\n        echo \"  Admin Password: (set)\"\n    else\n        echo \"âš ï¸  Authentication: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Context Storage: $NODERED_CONTEXT_STORAGE\"\n\n    if [ \"$NODERED_CONTEXT_STORAGE\" = \"redis\" ]; then\n        echo \"  Redis: $REDIS_HOST:$REDIS_PORT\"\n        echo \"  DB: $REDIS_DB\"\n    fi\n\n    echo \"\"\n    if [ \"$NODERED_PROJECTS_ENABLED\" = \"true\" ]; then\n        echo \"Projects: Enabled ($NODERED_PROJECTS_WORKFLOW_MODE mode)\"\n    else\n        echo \"Projects: Disabled\"\n    fi\n\n    echo \"\"\n    echo \"Paths:\"\n    echo \"  User Directory: $NODERED_DATA_DIR\"\n    echo \"  Settings: $NODERED_DATA_DIR/settings.js\"\n    echo \"  Credential Secret: $FLOX_ENV_CACHE/nodered-credential.key\"\n\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox services status              Check service status\"\n    echo \"  flox services logs nodered        View Node-RED logs\"\n    echo \"  flox services restart             Restart services\"\n}\n\nnodered-reconfigure() {\n    reconfigure_nodered\n}\n\nnodered-hash-password() {\n    echo \"Generate bcrypt password hash for Node-RED:\"\n    echo \"\"\n    node-red-admin hash-pw\n}\n",
        "fish": "function nodered-info\n    echo \"Node-RED Environment Configuration\"\n    echo \"\"\n    echo \"Server:\"\n    echo \"  URL: http://localhost:$NODERED_PORT\"\n    echo \"  Dashboard: http://localhost:$NODERED_PORT/ui\"\n    echo \"  Listen: $NODERED_HOST:$NODERED_PORT\"\n    echo \"\"\n\n    if test \"$NODERED_ADMIN_AUTH_ENABLED\" = \"true\"\n        echo \"Authentication: Enabled\"\n        echo \"  Admin Username: $NODERED_ADMIN_USER\"\n        echo \"  Admin Password: (set)\"\n    else\n        echo \"âš ï¸  Authentication: Disabled\"\n    end\n\n    echo \"\"\n    echo \"Context Storage: $NODERED_CONTEXT_STORAGE\"\n\n    if test \"$NODERED_CONTEXT_STORAGE\" = \"redis\"\n        echo \"  Redis: $REDIS_HOST:$REDIS_PORT\"\n        echo \"  DB: $REDIS_DB\"\n    end\n\n    echo \"\"\n    if test \"$NODERED_PROJECTS_ENABLED\" = \"true\"\n        echo \"Projects: Enabled ($NODERED_PROJECTS_WORKFLOW_MODE mode)\"\n    else\n        echo \"Projects: Disabled\"\n    end\n\n    echo \"\"\n    echo \"Paths:\"\n    echo \"  User Directory: $NODERED_DATA_DIR\"\n    echo \"  Settings: $NODERED_DATA_DIR/settings.js\"\n    echo \"  Credential Secret: $FLOX_ENV_CACHE/nodered-credential.key\"\n\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox services status              Check service status\"\n    echo \"  flox services logs nodered        View Node-RED logs\"\n    echo \"  flox services restart             Restart services\"\nend\n\nfunction nodered-reconfigure\n    reconfigure_nodered\nend\n\nfunction nodered-hash-password\n    echo \"Generate bcrypt password hash for Node-RED:\"\n    echo \"\"\n    node-red-admin hash-pw\nend\n"
      },
      "options": {
        "systems": [
          "aarch64-darwin",
          "aarch64-linux",
          "x86_64-darwin",
          "x86_64-linux"
        ]
      },
      "services": {
        "nodered": {
          "command": "# Ensure credential secret exists\nif [ -z \"$NODERED_CREDENTIAL_SECRET\" ]; then\n    echo \"ERROR: NODERED_CREDENTIAL_SECRET not set\"\n    return 1\nfi\n\n# Ensure settings.js exists\nif [ ! -f \"$NODERED_DATA_DIR/settings.js\" ]; then\n    echo \"ERROR: settings.js not found in $NODERED_DATA_DIR\"\n    return 1\nfi\n\n# Export credential secret\nexport NODERED_CREDENTIAL_SECRET\n\n# Start Node-RED\nexec node-red \\\n  --port \"$NODERED_PORT\" \\\n  --userDir \"$NODERED_DATA_DIR\" \\\n  --settings \"$NODERED_DATA_DIR/settings.js\"\n"
        }
      },
      "include": {
        "environments": [
          {
            "remote": "barstoolbluz/redis-headless"
          }
        ]
      }
    },
    "include": [
      {
        "manifest": {
          "version": 1,
          "install": {
            "redis": {
              "pkg-path": "redis"
            }
          },
          "vars": {
            "REDIS_CONFIG_DIR": "$FLOX_ENV_CACHE/redis-config",
            "REDIS_DATA_DIR": "$FLOX_ENV_CACHE/redis-data",
            "REDIS_LOG_DIR": "$FLOX_ENV_CACHE/redis-logs"
          },
          "hook": {
            "on-activate": "# Create required directories\nmkdir -p \"$FLOX_ENV_CACHE/redis-config\"\nmkdir -p \"$FLOX_ENV_CACHE/redis-logs\"\nmkdir -p \"$FLOX_ENV_CACHE/redis-data\"\n\n# === RUNTIME VARIABLES - Connection ===\nexport REDIS_HOST=\"${REDIS_HOST:-127.0.0.1}\"\nexport REDIS_PORT=\"${REDIS_PORT:-16379}\"\nexport REDIS_PASSWORD=\"${REDIS_PASSWORD:-}\"\n\n# === RUNTIME VARIABLES - Memory Management ===\nexport REDIS_MAXMEMORY=\"${REDIS_MAXMEMORY:-256mb}\"\nexport REDIS_MAXMEMORY_POLICY=\"${REDIS_MAXMEMORY_POLICY:-noeviction}\"\nexport REDIS_MAXMEMORY_SAMPLES=\"${REDIS_MAXMEMORY_SAMPLES:-5}\"\n\n# === RUNTIME VARIABLES - Persistence (RDB) ===\nexport REDIS_SAVE_RDB=\"${REDIS_SAVE_RDB:-yes}\"\nexport REDIS_SAVE_900=\"${REDIS_SAVE_900:-1}\"\nexport REDIS_SAVE_300=\"${REDIS_SAVE_300:-10}\"\nexport REDIS_SAVE_60=\"${REDIS_SAVE_60:-10000}\"\nexport REDIS_RDB_COMPRESSION=\"${REDIS_RDB_COMPRESSION:-yes}\"\nexport REDIS_RDB_CHECKSUM=\"${REDIS_RDB_CHECKSUM:-yes}\"\n\n# === RUNTIME VARIABLES - Persistence (AOF) ===\nexport REDIS_APPENDONLY=\"${REDIS_APPENDONLY:-no}\"\nexport REDIS_APPENDFSYNC=\"${REDIS_APPENDFSYNC:-everysec}\"\nexport REDIS_AOF_REWRITE_PERCENTAGE=\"${REDIS_AOF_REWRITE_PERCENTAGE:-100}\"\nexport REDIS_AOF_REWRITE_MIN_SIZE=\"${REDIS_AOF_REWRITE_MIN_SIZE:-64mb}\"\n\n# === RUNTIME VARIABLES - Performance ===\nexport REDIS_DATABASES=\"${REDIS_DATABASES:-16}\"\nexport REDIS_TCP_BACKLOG=\"${REDIS_TCP_BACKLOG:-511}\"\nexport REDIS_TIMEOUT=\"${REDIS_TIMEOUT:-0}\"\nexport REDIS_TCP_KEEPALIVE=\"${REDIS_TCP_KEEPALIVE:-300}\"\nexport REDIS_MAXCLIENTS=\"${REDIS_MAXCLIENTS:-10000}\"\n\n# === RUNTIME VARIABLES - Slow Log ===\nexport REDIS_SLOWLOG_LOG_SLOWER_THAN=\"${REDIS_SLOWLOG_LOG_SLOWER_THAN:-10000}\"\nexport REDIS_SLOWLOG_MAX_LEN=\"${REDIS_SLOWLOG_MAX_LEN:-128}\"\n\n# === RUNTIME VARIABLES - Latency Monitor ===\nexport REDIS_LATENCY_MONITOR_THRESHOLD=\"${REDIS_LATENCY_MONITOR_THRESHOLD:-0}\"\n\n# === RUNTIME VARIABLES - Security ===\nexport REDIS_PROTECTED_MODE=\"${REDIS_PROTECTED_MODE:-yes}\"\nexport REDIS_RENAME_COMMANDS=\"${REDIS_RENAME_COMMANDS:-}\"\n\n# === FLEXIBILITY ===\nexport REDIS_EXTRA_OPTS=\"${REDIS_EXTRA_OPTS:-}\"\n\n# === DERIVED VARIABLES ===\nexport REDIS_DIR=\"${REDIS_DIR:-$FLOX_ENV_CACHE/redis-data}\"\nexport REDIS_CONF_FILE=\"$REDIS_CONFIG_DIR/redis.conf\"\nexport REDIS_LOG_FILE=\"$REDIS_LOG_DIR/redis.log\"\n\n# === CONFIGURATION GENERATION ===\ngenerate_redis_config() {\n    # Ensure directories exist\n    mkdir -p \"$REDIS_DIR\" \"$REDIS_CONFIG_DIR\" \"$REDIS_LOG_DIR\"\n    chmod 700 \"$REDIS_DIR\" \"$REDIS_CONFIG_DIR\"\n\n    cat > \"$REDIS_CONF_FILE\" << EOF\n# Redis configuration generated by Flox (headless mode)\n# Connection\nbind $REDIS_HOST\nport $REDIS_PORT\nprotected-mode $REDIS_PROTECTED_MODE\n\n# General\ndaemonize no\ndir $REDIS_DIR\nlogfile $REDIS_LOG_FILE\ndatabases $REDIS_DATABASES\n\n# Network\ntcp-backlog $REDIS_TCP_BACKLOG\ntimeout $REDIS_TIMEOUT\ntcp-keepalive $REDIS_TCP_KEEPALIVE\n\n# Clients\nmaxclients $REDIS_MAXCLIENTS\n\n# Memory Management\nmaxmemory $REDIS_MAXMEMORY\nmaxmemory-policy $REDIS_MAXMEMORY_POLICY\nmaxmemory-samples $REDIS_MAXMEMORY_SAMPLES\n\nEOF\n\n    # Add password if set\n    if [ -n \"$REDIS_PASSWORD\" ]; then\n        echo \"# Security\" >> \"$REDIS_CONF_FILE\"\n        echo \"requirepass $REDIS_PASSWORD\" >> \"$REDIS_CONF_FILE\"\n        echo \"\" >> \"$REDIS_CONF_FILE\"\n    fi\n\n    # Add command renaming if set\n    if [ -n \"$REDIS_RENAME_COMMANDS\" ]; then\n        echo \"# Command renaming\" >> \"$REDIS_CONF_FILE\"\n        # Format: \"FLUSHDB,FLUSHALL,CONFIG\" -> rename-command FLUSHDB \"\", rename-command FLUSHALL \"\"\n        IFS=',' read -ra CMDS <<< \"$REDIS_RENAME_COMMANDS\"\n        for cmd in \"${CMDS[@]}\"; do\n            echo \"rename-command $cmd \\\"\\\"\" >> \"$REDIS_CONF_FILE\"\n        done\n        echo \"\" >> \"$REDIS_CONF_FILE\"\n    fi\n\n    # RDB Persistence\n    echo \"# RDB Persistence\" >> \"$REDIS_CONF_FILE\"\n    if [ \"$REDIS_SAVE_RDB\" = \"yes\" ]; then\n        echo \"save 900 $REDIS_SAVE_900\" >> \"$REDIS_CONF_FILE\"\n        echo \"save 300 $REDIS_SAVE_300\" >> \"$REDIS_CONF_FILE\"\n        echo \"save 60 $REDIS_SAVE_60\" >> \"$REDIS_CONF_FILE\"\n        echo \"rdbcompression $REDIS_RDB_COMPRESSION\" >> \"$REDIS_CONF_FILE\"\n        echo \"rdbchecksum $REDIS_RDB_CHECKSUM\" >> \"$REDIS_CONF_FILE\"\n    else\n        echo \"save \\\"\\\"\" >> \"$REDIS_CONF_FILE\"\n    fi\n    echo \"\" >> \"$REDIS_CONF_FILE\"\n\n    # AOF Persistence\n    echo \"# AOF Persistence\" >> \"$REDIS_CONF_FILE\"\n    echo \"appendonly $REDIS_APPENDONLY\" >> \"$REDIS_CONF_FILE\"\n    if [ \"$REDIS_APPENDONLY\" = \"yes\" ]; then\n        echo \"appendfsync $REDIS_APPENDFSYNC\" >> \"$REDIS_CONF_FILE\"\n        echo \"auto-aof-rewrite-percentage $REDIS_AOF_REWRITE_PERCENTAGE\" >> \"$REDIS_CONF_FILE\"\n        echo \"auto-aof-rewrite-min-size $REDIS_AOF_REWRITE_MIN_SIZE\" >> \"$REDIS_CONF_FILE\"\n    fi\n    echo \"\" >> \"$REDIS_CONF_FILE\"\n\n    # Slow Log\n    echo \"# Slow Log\" >> \"$REDIS_CONF_FILE\"\n    echo \"slowlog-log-slower-than $REDIS_SLOWLOG_LOG_SLOWER_THAN\" >> \"$REDIS_CONF_FILE\"\n    echo \"slowlog-max-len $REDIS_SLOWLOG_MAX_LEN\" >> \"$REDIS_CONF_FILE\"\n    echo \"\" >> \"$REDIS_CONF_FILE\"\n\n    # Latency Monitor\n    echo \"# Latency Monitor\" >> \"$REDIS_CONF_FILE\"\n    echo \"latency-monitor-threshold $REDIS_LATENCY_MONITOR_THRESHOLD\" >> \"$REDIS_CONF_FILE\"\n\n    chmod 644 \"$REDIS_CONF_FILE\"\n    return 0\n}\n\n# Generate configuration on activation\ngenerate_redis_config\n\n# Display info with safety warnings\necho \"\"\necho \"âœ… Redis environment ready (headless mode)\"\necho \"\"\n\n# Safety warnings\nif [ \"$REDIS_PROTECTED_MODE\" = \"no\" ]; then\n    echo \"âš ï¸  WARNING: Protected mode disabled - EXPOSED TO NETWORK\"\nfi\nif [ -z \"$REDIS_PASSWORD\" ]; then\n    echo \"âš ï¸  WARNING: No password set - UNAUTHENTICATED ACCESS\"\nfi\nif [ \"$REDIS_HOST\" = \"0.0.0.0\" ]; then\n    echo \"âš ï¸  WARNING: Listening on all interfaces - NETWORK EXPOSED\"\nfi\nif [ \"$REDIS_APPENDONLY\" = \"no\" ] && [ \"$REDIS_SAVE_RDB\" = \"no\" ]; then\n    echo \"âš ï¸  WARNING: All persistence disabled - DATA LOSS ON RESTART\"\nfi\n[ \"$REDIS_PROTECTED_MODE\" = \"no\" ] || [ -z \"$REDIS_PASSWORD\" ] || [ \"$REDIS_HOST\" = \"0.0.0.0\" ] || [ \"$REDIS_APPENDONLY\" = \"no\" -a \"$REDIS_SAVE_RDB\" = \"no\" ] && echo \"\"\n\necho \"Connection:\"\necho \"  Host: ${REDIS_HOST}:${REDIS_PORT}\"\nif [ -n \"$REDIS_PASSWORD\" ]; then\n    echo \"  Password: ***\"\nelse\n    echo \"  Password: (none)\"\nfi\necho \"\"\necho \"Memory:\"\necho \"  Max memory: ${REDIS_MAXMEMORY}\"\necho \"  Eviction policy: ${REDIS_MAXMEMORY_POLICY}\"\necho \"\"\necho \"Persistence:\"\necho \"  RDB snapshots: ${REDIS_SAVE_RDB}\"\necho \"  AOF logging: ${REDIS_APPENDONLY}\"\necho \"\"\necho \"Commands:\"\necho \"  flox activate -s        Start Redis\"\necho \"  redis-cli               Connect to Redis\"\necho \"  redis-info              Show configuration\"\necho \"\"\n"
          },
          "profile": {
            "bash": "redis-info() {\n    echo \"Redis (Headless Mode) - Configuration\"\n    echo \"\"\n    echo \"Connection:\"\n    echo \"  Host: ${REDIS_HOST}:${REDIS_PORT}\"\n    if [ -n \"$REDIS_PASSWORD\" ]; then\n        echo \"  Password: ***\"\n    else\n        echo \"  Password: (none)\"\n    fi\n    echo \"  Protected mode: ${REDIS_PROTECTED_MODE}\"\n    echo \"\"\n    echo \"Memory:\"\n    echo \"  Max memory: ${REDIS_MAXMEMORY}\"\n    echo \"  Eviction policy: ${REDIS_MAXMEMORY_POLICY}\"\n    echo \"  Eviction samples: ${REDIS_MAXMEMORY_SAMPLES}\"\n    echo \"\"\n    echo \"Persistence (RDB):\"\n    echo \"  Enabled: ${REDIS_SAVE_RDB}\"\n    if [ \"$REDIS_SAVE_RDB\" = \"yes\" ]; then\n        echo \"  Save after 900s if ${REDIS_SAVE_900}+ changes\"\n        echo \"  Save after 300s if ${REDIS_SAVE_300}+ changes\"\n        echo \"  Save after 60s if ${REDIS_SAVE_60}+ changes\"\n        echo \"  Compression: ${REDIS_RDB_COMPRESSION}\"\n        echo \"  Checksum: ${REDIS_RDB_CHECKSUM}\"\n    fi\n    echo \"\"\n    echo \"Persistence (AOF):\"\n    echo \"  Enabled: ${REDIS_APPENDONLY}\"\n    if [ \"$REDIS_APPENDONLY\" = \"yes\" ]; then\n        echo \"  Fsync policy: ${REDIS_APPENDFSYNC}\"\n        echo \"  Rewrite percentage: ${REDIS_AOF_REWRITE_PERCENTAGE}\"\n        echo \"  Rewrite min size: ${REDIS_AOF_REWRITE_MIN_SIZE}\"\n    fi\n    echo \"\"\n    echo \"Performance:\"\n    echo \"  Databases: ${REDIS_DATABASES}\"\n    echo \"  Max clients: ${REDIS_MAXCLIENTS}\"\n    echo \"  TCP backlog: ${REDIS_TCP_BACKLOG}\"\n    echo \"  Timeout: ${REDIS_TIMEOUT}s\"\n    echo \"  TCP keepalive: ${REDIS_TCP_KEEPALIVE}s\"\n    echo \"\"\n    echo \"Monitoring:\"\n    echo \"  Slow log threshold: ${REDIS_SLOWLOG_LOG_SLOWER_THAN}Î¼s\"\n    echo \"  Slow log max length: ${REDIS_SLOWLOG_MAX_LEN}\"\n    echo \"  Latency monitor threshold: ${REDIS_LATENCY_MONITOR_THRESHOLD}ms\"\n    echo \"\"\n    echo \"Data Directory: ${REDIS_DIR}\"\n    echo \"Config File: ${REDIS_CONF_FILE}\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  redis-cli                       Connect to Redis\"\n    echo \"  flox activate -s                Start Redis service\"\n    echo \"  flox services status            Check service status\"\n    echo \"  flox services logs redis        View service logs\"\n    echo \"  flox services restart redis     Restart with new settings\"\n}\nexport -f redis-info\n",
            "zsh": "redis-info() {\n    echo \"Redis (Headless Mode) - Configuration\"\n    echo \"\"\n    echo \"Connection:\"\n    echo \"  Host: ${REDIS_HOST}:${REDIS_PORT}\"\n    if [ -n \"$REDIS_PASSWORD\" ]; then\n        echo \"  Password: ***\"\n    else\n        echo \"  Password: (none)\"\n    fi\n    echo \"  Protected mode: ${REDIS_PROTECTED_MODE}\"\n    echo \"\"\n    echo \"Memory:\"\n    echo \"  Max memory: ${REDIS_MAXMEMORY}\"\n    echo \"  Eviction policy: ${REDIS_MAXMEMORY_POLICY}\"\n    echo \"  Eviction samples: ${REDIS_MAXMEMORY_SAMPLES}\"\n    echo \"\"\n    echo \"Persistence (RDB):\"\n    echo \"  Enabled: ${REDIS_SAVE_RDB}\"\n    if [ \"$REDIS_SAVE_RDB\" = \"yes\" ]; then\n        echo \"  Save after 900s if ${REDIS_SAVE_900}+ changes\"\n        echo \"  Save after 300s if ${REDIS_SAVE_300}+ changes\"\n        echo \"  Save after 60s if ${REDIS_SAVE_60}+ changes\"\n        echo \"  Compression: ${REDIS_RDB_COMPRESSION}\"\n        echo \"  Checksum: ${REDIS_RDB_CHECKSUM}\"\n    fi\n    echo \"\"\n    echo \"Persistence (AOF):\"\n    echo \"  Enabled: ${REDIS_APPENDONLY}\"\n    if [ \"$REDIS_APPENDONLY\" = \"yes\" ]; then\n        echo \"  Fsync policy: ${REDIS_APPENDFSYNC}\"\n        echo \"  Rewrite percentage: ${REDIS_AOF_REWRITE_PERCENTAGE}\"\n        echo \"  Rewrite min size: ${REDIS_AOF_REWRITE_MIN_SIZE}\"\n    fi\n    echo \"\"\n    echo \"Performance:\"\n    echo \"  Databases: ${REDIS_DATABASES}\"\n    echo \"  Max clients: ${REDIS_MAXCLIENTS}\"\n    echo \"  TCP backlog: ${REDIS_TCP_BACKLOG}\"\n    echo \"  Timeout: ${REDIS_TIMEOUT}s\"\n    echo \"  TCP keepalive: ${REDIS_TCP_KEEPALIVE}s\"\n    echo \"\"\n    echo \"Monitoring:\"\n    echo \"  Slow log threshold: ${REDIS_SLOWLOG_LOG_SLOWER_THAN}Î¼s\"\n    echo \"  Slow log max length: ${REDIS_SLOWLOG_MAX_LEN}\"\n    echo \"  Latency monitor threshold: ${REDIS_LATENCY_MONITOR_THRESHOLD}ms\"\n    echo \"\"\n    echo \"Data Directory: ${REDIS_DIR}\"\n    echo \"Config File: ${REDIS_CONF_FILE}\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  redis-cli                       Connect to Redis\"\n    echo \"  flox activate -s                Start Redis service\"\n    echo \"  flox services status            Check service status\"\n    echo \"  flox services logs redis        View service logs\"\n    echo \"  flox services restart redis     Restart with new settings\"\n}\n",
            "fish": "function redis-info\n    echo \"Redis (Headless Mode) - Configuration\"\n    echo \"\"\n    echo \"Connection:\"\n    echo \"  Host: $REDIS_HOST:$REDIS_PORT\"\n    if test -n \"$REDIS_PASSWORD\"\n        echo \"  Password: ***\"\n    else\n        echo \"  Password: (none)\"\n    end\n    echo \"  Protected mode: $REDIS_PROTECTED_MODE\"\n    echo \"\"\n    echo \"Memory:\"\n    echo \"  Max memory: $REDIS_MAXMEMORY\"\n    echo \"  Eviction policy: $REDIS_MAXMEMORY_POLICY\"\n    echo \"  Eviction samples: $REDIS_MAXMEMORY_SAMPLES\"\n    echo \"\"\n    echo \"Persistence (RDB):\"\n    echo \"  Enabled: $REDIS_SAVE_RDB\"\n    if test \"$REDIS_SAVE_RDB\" = \"yes\"\n        echo \"  Save after 900s if $REDIS_SAVE_900+ changes\"\n        echo \"  Save after 300s if $REDIS_SAVE_300+ changes\"\n        echo \"  Save after 60s if $REDIS_SAVE_60+ changes\"\n        echo \"  Compression: $REDIS_RDB_COMPRESSION\"\n        echo \"  Checksum: $REDIS_RDB_CHECKSUM\"\n    end\n    echo \"\"\n    echo \"Persistence (AOF):\"\n    echo \"  Enabled: $REDIS_APPENDONLY\"\n    if test \"$REDIS_APPENDONLY\" = \"yes\"\n        echo \"  Fsync policy: $REDIS_APPENDFSYNC\"\n        echo \"  Rewrite percentage: $REDIS_AOF_REWRITE_PERCENTAGE\"\n        echo \"  Rewrite min size: $REDIS_AOF_REWRITE_MIN_SIZE\"\n    end\n    echo \"\"\n    echo \"Performance:\"\n    echo \"  Databases: $REDIS_DATABASES\"\n    echo \"  Max clients: $REDIS_MAXCLIENTS\"\n    echo \"  TCP backlog: $REDIS_TCP_BACKLOG\"\n    echo \"  Timeout: $REDIS_TIMEOUT\"s\n    echo \"  TCP keepalive: $REDIS_TCP_KEEPALIVE\"s\n    echo \"\"\n    echo \"Monitoring:\"\n    echo \"  Slow log threshold: $REDIS_SLOWLOG_LOG_SLOWER_THAN\"Î¼s\n    echo \"  Slow log max length: $REDIS_SLOWLOG_MAX_LEN\"\n    echo \"  Latency monitor threshold: $REDIS_LATENCY_MONITOR_THRESHOLD\"ms\n    echo \"\"\n    echo \"Data Directory: $REDIS_DIR\"\n    echo \"Config File: $REDIS_CONF_FILE\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  redis-cli                       Connect to Redis\"\n    echo \"  flox activate -s                Start Redis service\"\n    echo \"  flox services status            Check service status\"\n    echo \"  flox services logs redis        View service logs\"\n    echo \"  flox services restart redis     Restart with new settings\"\nend\n"
          },
          "options": {
            "systems": [
              "aarch64-darwin",
              "aarch64-linux",
              "x86_64-darwin",
              "x86_64-linux"
            ]
          },
          "services": {
            "redis": {
              "command": "redis-server $REDIS_CONF_FILE"
            }
          }
        },
        "name": "redis-headless",
        "descriptor": {
          "remote": "barstoolbluz/redis-headless"
        }
      }
    ],
    "warnings": [
      {
        "warning": {
          "Overriding": [
            "options",
            "systems"
          ]
        },
        "higher_priority_name": "Current manifest"
      }
    ]
  }
}