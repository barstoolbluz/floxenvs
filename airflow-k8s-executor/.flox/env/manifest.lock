{
  "lockfile-version": 1,
  "manifest": {
    "version": 1,
    "install": {
      "airflow": {
        "pkg-path": "barstoolbluz/airflow-full-3-1-1",
        "systems": [
          "x86_64-linux"
        ]
      },
      "bat": {
        "pkg-path": "bat"
      },
      "coreutils": {
        "pkg-path": "coreutils",
        "pkg-group": "darwin-tools"
      },
      "curl": {
        "pkg-path": "curl"
      },
      "jq": {
        "pkg-path": "jq"
      },
      "kind": {
        "pkg-path": "kind"
      },
      "kubectl": {
        "pkg-path": "kubectl"
      }
    },
    "vars": {
      "AIRFLOW_KUBE_CONFIG_DIR": "$FLOX_ENV_CACHE/k8s-config",
      "AIRFLOW_KUBE_LOG_DIR": "$FLOX_ENV_CACHE/k8s-logs",
      "AIRFLOW_KUBE_TEMPLATES_DIR": "$FLOX_ENV_CACHE/k8s-templates",
      "KIND_CONFIG_DIR": "$FLOX_ENV_CACHE/kind-config",
      "KIND_DATA_DIR": "$FLOX_ENV_CACHE/kind-data",
      "KIND_LOG_DIR": "$FLOX_ENV_CACHE/kind-logs"
    },
    "hook": {
      "on-activate": "# Create required directories\nmkdir -p \"$FLOX_ENV_CACHE/kind-config\"\nmkdir -p \"$FLOX_ENV_CACHE/kind-logs\"\nmkdir -p \"$FLOX_ENV_CACHE/kind-data\"\n\n# Runtime-configurable variables with defaults\nexport KIND_CLUSTER_NAME=\"${KIND_CLUSTER_NAME:-kind}\"\nexport KIND_CONFIG_FILE=\"${KIND_CONFIG_FILE:-$KIND_CONFIG_DIR/cluster.yaml}\"\nexport KIND_KUBECONFIG=\"${KIND_KUBECONFIG:-$KIND_DATA_DIR/kubeconfig}\"\nexport KIND_IMAGE=\"${KIND_IMAGE:-}\"\n\n# Generate default KIND config if not exists\nif [ ! -f \"$KIND_CONFIG_FILE\" ]; then\n    cat > \"$KIND_CONFIG_FILE\" << 'EOF'\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n- role: worker\nEOF\nfi\n\n# Display minimal info\necho \"\"\necho \"✅ KIND environment ready (headless mode)\"\necho \"\"\necho \"Cluster Name: $KIND_CLUSTER_NAME\"\necho \"Config File:  $KIND_CONFIG_FILE\"\necho \"\"\necho \"Start cluster: flox activate -s\"\necho \"Check status:  flox services status\"\necho \"Show info:     kind-info\"\necho \"\"\n\n# Create required directories\nmkdir -p \"$FLOX_ENV_CACHE/k8s-config\"\nmkdir -p \"$FLOX_ENV_CACHE/k8s-templates\"\nmkdir -p \"$FLOX_ENV_CACHE/k8s-logs\"\n\n# === KUBERNETES CONNECTION ===\nexport AIRFLOW_KUBE_NAMESPACE=\"${AIRFLOW_KUBE_NAMESPACE:-default}\"\nexport AIRFLOW_KUBE_CONFIG=\"${AIRFLOW_KUBE_CONFIG:-$KIND_KUBECONFIG}\"\nexport AIRFLOW_KUBE_IN_CLUSTER=\"${AIRFLOW_KUBE_IN_CLUSTER:-False}\"\n\n# === POD CONFIGURATION ===\nexport AIRFLOW_KUBE_IMAGE_PULL_POLICY=\"${AIRFLOW_KUBE_IMAGE_PULL_POLICY:-IfNotPresent}\"\nexport AIRFLOW_KUBE_DELETE_WORKER_PODS=\"${AIRFLOW_KUBE_DELETE_WORKER_PODS:-True}\"\nexport AIRFLOW_KUBE_DELETE_WORKER_PODS_ON_FAILURE=\"${AIRFLOW_KUBE_DELETE_WORKER_PODS_ON_FAILURE:-False}\"\nexport AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT=\"${AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT:-airflow}\"\n\n# === RESOURCE LIMITS ===\nexport AIRFLOW_KUBE_WORKER_CPU_REQUEST=\"${AIRFLOW_KUBE_WORKER_CPU_REQUEST:-100m}\"\nexport AIRFLOW_KUBE_WORKER_CPU_LIMIT=\"${AIRFLOW_KUBE_WORKER_CPU_LIMIT:-1000m}\"\nexport AIRFLOW_KUBE_WORKER_MEM_REQUEST=\"${AIRFLOW_KUBE_WORKER_MEM_REQUEST:-512Mi}\"\nexport AIRFLOW_KUBE_WORKER_MEM_LIMIT=\"${AIRFLOW_KUBE_WORKER_MEM_LIMIT:-2Gi}\"\n\n# === DERIVED PATHS ===\nexport AIRFLOW_KUBE_RBAC_CONFIG=\"$AIRFLOW_KUBE_CONFIG_DIR/rbac.yaml\"\nexport AIRFLOW_KUBE_POD_TEMPLATE=\"$AIRFLOW_KUBE_TEMPLATES_DIR/worker-pod-template.yaml\"\n\n# === GENERATE RBAC CONFIGURATION ===\ngenerate_rbac_config() {\n    cat > \"$AIRFLOW_KUBE_RBAC_CONFIG\" << EOF\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: airflow\n  namespace: $AIRFLOW_KUBE_NAMESPACE\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: airflow-role\n  namespace: $AIRFLOW_KUBE_NAMESPACE\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"pods\", \"pods/log\", \"pods/exec\"]\n    verbs: [\"get\", \"list\", \"watch\", \"create\", \"update\", \"delete\", \"patch\"]\n  - apiGroups: [\"\"]\n    resources: [\"configmaps\"]\n    verbs: [\"get\", \"list\", \"watch\"]\n  - apiGroups: [\"\"]\n    resources: [\"secrets\"]\n    verbs: [\"get\", \"list\"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: airflow-role-binding\n  namespace: $AIRFLOW_KUBE_NAMESPACE\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: airflow-role\nsubjects:\n  - kind: ServiceAccount\n    name: airflow\n    namespace: $AIRFLOW_KUBE_NAMESPACE\nEOF\n    chmod 644 \"$AIRFLOW_KUBE_RBAC_CONFIG\"\n    return 0\n}\n\n# === GENERATE POD TEMPLATE ===\ngenerate_pod_template() {\n    cat > \"$AIRFLOW_KUBE_POD_TEMPLATE\" << EOF\napiVersion: v1\nkind: Pod\nmetadata:\n  name: airflow-worker\n  namespace: $AIRFLOW_KUBE_NAMESPACE\nspec:\n  serviceAccountName: $AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT\n  containers:\n  - name: base\n    image: apache/airflow:3.1.1\n    imagePullPolicy: $AIRFLOW_KUBE_IMAGE_PULL_POLICY\n    resources:\n      requests:\n        cpu: \"$AIRFLOW_KUBE_WORKER_CPU_REQUEST\"\n        memory: \"$AIRFLOW_KUBE_WORKER_MEM_REQUEST\"\n      limits:\n        cpu: \"$AIRFLOW_KUBE_WORKER_CPU_LIMIT\"\n        memory: \"$AIRFLOW_KUBE_WORKER_MEM_LIMIT\"\n  restartPolicy: Never\nEOF\n    chmod 644 \"$AIRFLOW_KUBE_POD_TEMPLATE\"\n    return 0\n}\n\n# === VALIDATE KUBERNETES CONNECTION ===\nvalidate_k8s_connection() {\n    if [ ! -f \"$AIRFLOW_KUBE_CONFIG\" ]; then\n        echo \"⚠️  Warning: Kubeconfig not found: $AIRFLOW_KUBE_CONFIG\"\n        echo \"Make sure KIND cluster is started with: flox activate -s\"\n        return 1\n    fi\n\n    export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\n    if kubectl cluster-info > /dev/null 2>&1; then\n        return 0\n    else\n        echo \"⚠️  Warning: Cannot connect to Kubernetes cluster\"\n        echo \"Make sure KIND cluster is running\"\n        return 1\n    fi\n}\n\n# Generate configurations\ngenerate_rbac_config\ngenerate_pod_template\n\n# Validate connection (non-blocking)\nvalidate_k8s_connection\n\n# Display info\necho \"\"\necho \"✅ Airflow Kubernetes Executor environment ready\"\necho \"\"\necho \"Namespace: $AIRFLOW_KUBE_NAMESPACE\"\necho \"ServiceAccount: $AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT\"\necho \"\"\necho \"Resource Limits:\"\necho \"  CPU Request: $AIRFLOW_KUBE_WORKER_CPU_REQUEST\"\necho \"  CPU Limit: $AIRFLOW_KUBE_WORKER_CPU_LIMIT\"\necho \"  Memory Request: $AIRFLOW_KUBE_WORKER_MEM_REQUEST\"\necho \"  Memory Limit: $AIRFLOW_KUBE_WORKER_MEM_LIMIT\"\necho \"\"\necho \"Configuration Files:\"\necho \"  RBAC: $AIRFLOW_KUBE_RBAC_CONFIG\"\necho \"  Pod Template: $AIRFLOW_KUBE_POD_TEMPLATE\"\necho \"\"\necho \"Commands:\"\necho \"  flox activate -s        Setup Kubernetes RBAC\"\necho \"  k8s-airflow-info        Show configuration\"\necho \"  k8s-test-pod            Test pod creation\"\necho \"\"\n"
    },
    "profile": {
      "bash": "kind-info() {\n    echo \"KIND Cluster (Headless Mode)\"\n    echo \"\"\n    echo \"Cluster Name: $KIND_CLUSTER_NAME\"\n    echo \"Config File:  $KIND_CONFIG_FILE\"\n    echo \"Kubeconfig:   $KIND_KUBECONFIG\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox activate -s        Start KIND cluster service\"\n    echo \"  flox services status    Check service status\"\n    echo \"  flox services logs kind View service logs\"\n    echo \"  kubectl cluster-info    Show cluster information\"\n    echo \"  kind get clusters       List KIND clusters\"\n    echo \"\"\n    echo \"Runtime Configuration:\"\n    echo \"  KIND_CLUSTER_NAME       Default: $KIND_CLUSTER_NAME\"\n    echo \"  KIND_CONFIG_FILE        Default: $KIND_CONFIG_FILE\"\n    echo \"  KIND_KUBECONFIG         Default: $KIND_KUBECONFIG\"\n    echo \"  KIND_IMAGE              Default: (latest)\"\n    echo \"\"\n    echo \"Example:\"\n    echo \"  KIND_CLUSTER_NAME=dev KIND_CONFIG_FILE=./my-config.yaml flox activate -s\"\n}\n\nreadme() {\n  local readme_path=\"$FLOX_ENV_PROJECT/README.md\"\n  if [[ \"$1\" == \"--refresh\" ]] || [ ! -s \"$readme_path\" ]; then\n    curl -sL \"https://raw.githubusercontent.com/barstoolbluz/floxenvs/main/kind-basic/README.md\" > \"$readme_path\" 2>/dev/null\n  fi\n  if command -v bat &>/dev/null; then\n    bat --language markdown \"$readme_path\" 2>/dev/null\n  else\n    cat \"$readme_path\" 2>/dev/null\n  fi\n}\n\nk8s-airflow-info() {\n    export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Airflow Kubernetes Executor Environment\"\n    echo \"\"\n    echo \"Namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"ServiceAccount: $AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT\"\n    echo \"Kubeconfig: $AIRFLOW_KUBE_CONFIG\"\n    echo \"\"\n    echo \"Resource Limits:\"\n    echo \"  CPU Request: $AIRFLOW_KUBE_WORKER_CPU_REQUEST\"\n    echo \"  CPU Limit: $AIRFLOW_KUBE_WORKER_CPU_LIMIT\"\n    echo \"  Memory Request: $AIRFLOW_KUBE_WORKER_MEM_REQUEST\"\n    echo \"  Memory Limit: $AIRFLOW_KUBE_WORKER_MEM_LIMIT\"\n    echo \"\"\n    echo \"Pod Configuration:\"\n    echo \"  Image Pull Policy: $AIRFLOW_KUBE_IMAGE_PULL_POLICY\"\n    echo \"  Delete Worker Pods: $AIRFLOW_KUBE_DELETE_WORKER_PODS\"\n    echo \"  Delete On Failure: $AIRFLOW_KUBE_DELETE_WORKER_PODS_ON_FAILURE\"\n    echo \"\"\n    echo \"Configuration Files:\"\n    echo \"  RBAC: $AIRFLOW_KUBE_RBAC_CONFIG\"\n    echo \"  Pod Template: $AIRFLOW_KUBE_POD_TEMPLATE\"\n    echo \"\"\n    echo \"Kubernetes Status:\"\n    if kubectl cluster-info > /dev/null 2>&1; then\n        kubectl get nodes 2>/dev/null | head -n 5\n        echo \"\"\n        echo \"ServiceAccount:\"\n        kubectl get sa airflow -n \"$AIRFLOW_KUBE_NAMESPACE\" 2>/dev/null || echo \"  (Not created yet - run: flox activate -s)\"\n    else\n        echo \"  ❌ Cannot connect to cluster\"\n    fi\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  kubectl get pods -n $AIRFLOW_KUBE_NAMESPACE       View Airflow pods\"\n    echo \"  kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE View ServiceAccount\"\n    echo \"  kubectl logs <pod> -n $AIRFLOW_KUBE_NAMESPACE     View pod logs\"\n    echo \"  k8s-test-pod                                       Test pod creation\"\n    echo \"  flox services logs k8s-setup                       View setup logs\"\n}\nexport -f k8s-airflow-info\n\nk8s-test-pod() {\n    export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Testing Airflow pod creation in namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"\"\n\n    kubectl run test-airflow-pod \\\n        --image=apache/airflow:3.1.1 \\\n        --namespace=\"$AIRFLOW_KUBE_NAMESPACE\" \\\n        --serviceaccount=airflow \\\n        --restart=Never \\\n        --rm -it \\\n        -- python --version\n\n    if [ $? -eq 0 ]; then\n        echo \"\"\n        echo \"✅ Pod creation successful\"\n    else\n        echo \"\"\n        echo \"❌ Pod creation failed\"\n        echo \"Check RBAC with: kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE\"\n    fi\n}\nexport -f k8s-test-pod\n",
      "zsh": "kind-info() {\n    echo \"KIND Cluster (Headless Mode)\"\n    echo \"\"\n    echo \"Cluster Name: $KIND_CLUSTER_NAME\"\n    echo \"Config File:  $KIND_CONFIG_FILE\"\n    echo \"Kubeconfig:   $KIND_KUBECONFIG\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox activate -s        Start KIND cluster service\"\n    echo \"  flox services status    Check service status\"\n    echo \"  flox services logs kind View service logs\"\n    echo \"  kubectl cluster-info    Show cluster information\"\n    echo \"  kind get clusters       List KIND clusters\"\n    echo \"\"\n    echo \"Runtime Configuration:\"\n    echo \"  KIND_CLUSTER_NAME       Default: $KIND_CLUSTER_NAME\"\n    echo \"  KIND_CONFIG_FILE        Default: $KIND_CONFIG_FILE\"\n    echo \"  KIND_KUBECONFIG         Default: $KIND_KUBECONFIG\"\n    echo \"  KIND_IMAGE              Default: (latest)\"\n    echo \"\"\n    echo \"Example:\"\n    echo \"  KIND_CLUSTER_NAME=dev KIND_CONFIG_FILE=./my-config.yaml flox activate -s\"\n}\n\nreadme() {\n  local readme_path=\"$FLOX_ENV_PROJECT/README.md\"\n  if [[ \"$1\" == \"--refresh\" ]] || [ ! -s \"$readme_path\" ]; then\n    curl -sL \"https://raw.githubusercontent.com/barstoolbluz/floxenvs/main/kind-basic/README.md\" > \"$readme_path\" 2>/dev/null\n  fi\n  if command -v bat &>/dev/null; then\n    bat --language markdown \"$readme_path\" 2>/dev/null\n  else\n    cat \"$readme_path\" 2>/dev/null\n  fi\n}\n\nk8s-airflow-info() {\n    export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Airflow Kubernetes Executor Environment\"\n    echo \"\"\n    echo \"Namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"ServiceAccount: $AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT\"\n    echo \"Kubeconfig: $AIRFLOW_KUBE_CONFIG\"\n    echo \"\"\n    echo \"Resource Limits:\"\n    echo \"  CPU Request: $AIRFLOW_KUBE_WORKER_CPU_REQUEST\"\n    echo \"  CPU Limit: $AIRFLOW_KUBE_WORKER_CPU_LIMIT\"\n    echo \"  Memory Request: $AIRFLOW_KUBE_WORKER_MEM_REQUEST\"\n    echo \"  Memory Limit: $AIRFLOW_KUBE_WORKER_MEM_LIMIT\"\n    echo \"\"\n    echo \"Pod Configuration:\"\n    echo \"  Image Pull Policy: $AIRFLOW_KUBE_IMAGE_PULL_POLICY\"\n    echo \"  Delete Worker Pods: $AIRFLOW_KUBE_DELETE_WORKER_PODS\"\n    echo \"  Delete On Failure: $AIRFLOW_KUBE_DELETE_WORKER_PODS_ON_FAILURE\"\n    echo \"\"\n    echo \"Configuration Files:\"\n    echo \"  RBAC: $AIRFLOW_KUBE_RBAC_CONFIG\"\n    echo \"  Pod Template: $AIRFLOW_KUBE_POD_TEMPLATE\"\n    echo \"\"\n    echo \"Kubernetes Status:\"\n    if kubectl cluster-info > /dev/null 2>&1; then\n        kubectl get nodes 2>/dev/null | head -n 5\n        echo \"\"\n        echo \"ServiceAccount:\"\n        kubectl get sa airflow -n \"$AIRFLOW_KUBE_NAMESPACE\" 2>/dev/null || echo \"  (Not created yet - run: flox activate -s)\"\n    else\n        echo \"  ❌ Cannot connect to cluster\"\n    fi\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  kubectl get pods -n $AIRFLOW_KUBE_NAMESPACE       View Airflow pods\"\n    echo \"  kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE View ServiceAccount\"\n    echo \"  kubectl logs <pod> -n $AIRFLOW_KUBE_NAMESPACE     View pod logs\"\n    echo \"  k8s-test-pod                                       Test pod creation\"\n    echo \"  flox services logs k8s-setup                       View setup logs\"\n}\n\nk8s-test-pod() {\n    export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Testing Airflow pod creation in namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"\"\n\n    kubectl run test-airflow-pod \\\n        --image=apache/airflow:3.1.1 \\\n        --namespace=\"$AIRFLOW_KUBE_NAMESPACE\" \\\n        --serviceaccount=airflow \\\n        --restart=Never \\\n        --rm -it \\\n        -- python --version\n\n    if [ $? -eq 0 ]; then\n        echo \"\"\n        echo \"✅ Pod creation successful\"\n    else\n        echo \"\"\n        echo \"❌ Pod creation failed\"\n        echo \"Check RBAC with: kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE\"\n    fi\n}\n",
      "fish": "function kind-info\n    echo \"KIND Cluster (Headless Mode)\"\n    echo \"\"\n    echo \"Cluster Name: $KIND_CLUSTER_NAME\"\n    echo \"Config File:  $KIND_CONFIG_FILE\"\n    echo \"Kubeconfig:   $KIND_KUBECONFIG\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox activate -s        Start KIND cluster service\"\n    echo \"  flox services status    Check service status\"\n    echo \"  flox services logs kind View service logs\"\n    echo \"  kubectl cluster-info    Show cluster information\"\n    echo \"  kind get clusters       List KIND clusters\"\n    echo \"\"\n    echo \"Runtime Configuration:\"\n    echo \"  KIND_CLUSTER_NAME       Default: $KIND_CLUSTER_NAME\"\n    echo \"  KIND_CONFIG_FILE        Default: $KIND_CONFIG_FILE\"\n    echo \"  KIND_KUBECONFIG         Default: $KIND_KUBECONFIG\"\n    echo \"  KIND_IMAGE              Default: (latest)\"\n    echo \"\"\n    echo \"Example:\"\n    echo \"  KIND_CLUSTER_NAME=dev KIND_CONFIG_FILE=./my-config.yaml flox activate -s\"\nend\n\nfunction readme\n  set readme_path \"$FLOX_ENV_PROJECT/README.md\"\n  if test \"$argv[1]\" = \"--refresh\"; or test ! -s \"$readme_path\"\n    curl -sL \"https://raw.githubusercontent.com/barstoolbluz/floxenvs/main/kind-basic/README.md\" > \"$readme_path\" 2>/dev/null\n  end\n  if command -v bat >/dev/null 2>&1\n    bat --language markdown \"$readme_path\" 2>/dev/null\n  else\n    cat \"$readme_path\" 2>/dev/null\n  end\nend\n\nfunction k8s-airflow-info\n    set -x KUBECONFIG \"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Airflow Kubernetes Executor Environment\"\n    echo \"\"\n    echo \"Namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"ServiceAccount: $AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT\"\n    echo \"Kubeconfig: $AIRFLOW_KUBE_CONFIG\"\n    echo \"\"\n    echo \"Resource Limits:\"\n    echo \"  CPU Request: $AIRFLOW_KUBE_WORKER_CPU_REQUEST\"\n    echo \"  CPU Limit: $AIRFLOW_KUBE_WORKER_CPU_LIMIT\"\n    echo \"  Memory Request: $AIRFLOW_KUBE_WORKER_MEM_REQUEST\"\n    echo \"  Memory Limit: $AIRFLOW_KUBE_WORKER_MEM_LIMIT\"\n    echo \"\"\n    echo \"Pod Configuration:\"\n    echo \"  Image Pull Policy: $AIRFLOW_KUBE_IMAGE_PULL_POLICY\"\n    echo \"  Delete Worker Pods: $AIRFLOW_KUBE_DELETE_WORKER_PODS\"\n    echo \"  Delete On Failure: $AIRFLOW_KUBE_DELETE_WORKER_PODS_ON_FAILURE\"\n    echo \"\"\n    echo \"Configuration Files:\"\n    echo \"  RBAC: $AIRFLOW_KUBE_RBAC_CONFIG\"\n    echo \"  Pod Template: $AIRFLOW_KUBE_POD_TEMPLATE\"\n    echo \"\"\n    echo \"Kubernetes Status:\"\n    if kubectl cluster-info > /dev/null 2>&1\n        kubectl get nodes 2>/dev/null | head -n 5\n        echo \"\"\n        echo \"ServiceAccount:\"\n        kubectl get sa airflow -n \"$AIRFLOW_KUBE_NAMESPACE\" 2>/dev/null; or echo \"  (Not created yet - run: flox activate -s)\"\n    else\n        echo \"  ❌ Cannot connect to cluster\"\n    end\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  kubectl get pods -n $AIRFLOW_KUBE_NAMESPACE       View Airflow pods\"\n    echo \"  kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE View ServiceAccount\"\n    echo \"  kubectl logs <pod> -n $AIRFLOW_KUBE_NAMESPACE     View pod logs\"\n    echo \"  k8s-test-pod                                       Test pod creation\"\n    echo \"  flox services logs k8s-setup                       View setup logs\"\nend\n\nfunction k8s-test-pod\n    set -x KUBECONFIG \"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Testing Airflow pod creation in namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"\"\n\n    kubectl run test-airflow-pod \\\n        --image=apache/airflow:3.1.1 \\\n        --namespace=\"$AIRFLOW_KUBE_NAMESPACE\" \\\n        --serviceaccount=airflow \\\n        --restart=Never \\\n        --rm -it \\\n        -- python --version\n\n    if test $status -eq 0\n        echo \"\"\n        echo \"✅ Pod creation successful\"\n    else\n        echo \"\"\n        echo \"❌ Pod creation failed\"\n        echo \"Check RBAC with: kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE\"\n    end\nend\n"
    },
    "options": {
      "systems": [
        "aarch64-darwin",
        "aarch64-linux",
        "x86_64-darwin",
        "x86_64-linux"
      ]
    },
    "services": {
      "k8s-setup": {
        "command": "export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\necho \"=== Kubernetes Setup Service ===\" | tee \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\necho \"Starting at $(date)\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n\n# Wait for cluster to be ready\necho \"Waiting for cluster to be ready...\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\nif ! kubectl wait --for=condition=Ready nodes --all --timeout=120s 2>&1 | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"; then\n    echo \"❌ Cluster not ready\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n    exit 1\nfi\n\n# Create namespace\necho \"Creating namespace '$AIRFLOW_KUBE_NAMESPACE'...\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\nkubectl create namespace \"$AIRFLOW_KUBE_NAMESPACE\" --dry-run=client -o yaml | kubectl apply -f - 2>&1 | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n\n# Apply RBAC\necho \"Applying RBAC configuration...\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\nif kubectl apply -f \"$AIRFLOW_KUBE_RBAC_CONFIG\" 2>&1 | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"; then\n    echo \"✅ RBAC configured successfully\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\nelse\n    echo \"❌ Failed to apply RBAC\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n    exit 1\nfi\n\n# Verify ServiceAccount\necho \"\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\necho \"ServiceAccount created:\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\nkubectl get serviceaccount airflow -n \"$AIRFLOW_KUBE_NAMESPACE\" 2>&1 | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n\necho \"\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\necho \"✅ Kubernetes executor environment ready\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\necho \"Pod template available at: $AIRFLOW_KUBE_POD_TEMPLATE\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n\n# Keep service running\ntail -f /dev/null\n"
      },
      "kind": {
        "command": "mkdir -p \"$KIND_LOG_DIR\"\nmkdir -p \"$KIND_DATA_DIR\"\n\n# Log startup\necho \"=== KIND Service Startup ===\" > \"$KIND_LOG_DIR/service.log\"\necho \"Starting at $(date)\" >> \"$KIND_LOG_DIR/service.log\"\necho \"KIND_CLUSTER_NAME = $KIND_CLUSTER_NAME\" >> \"$KIND_LOG_DIR/service.log\"\necho \"KIND_CONFIG_FILE = $KIND_CONFIG_FILE\" >> \"$KIND_LOG_DIR/service.log\"\n\n# Check if cluster already exists\nif kind get clusters 2>/dev/null | grep -q \"^${KIND_CLUSTER_NAME}$\"; then\n    echo \"Cluster '$KIND_CLUSTER_NAME' already exists\" | tee -a \"$KIND_LOG_DIR/service.log\"\nelse\n    echo \"Creating KIND cluster '$KIND_CLUSTER_NAME'...\" | tee -a \"$KIND_LOG_DIR/service.log\"\n\n    # Build kind create command\n    KIND_CMD=\"kind create cluster --name $KIND_CLUSTER_NAME\"\n\n    # Add config file if it exists\n    if [ -f \"$KIND_CONFIG_FILE\" ]; then\n        KIND_CMD=\"$KIND_CMD --config $KIND_CONFIG_FILE\"\n    fi\n\n    # Add image if specified\n    if [ -n \"$KIND_IMAGE\" ]; then\n        KIND_CMD=\"$KIND_CMD --image $KIND_IMAGE\"\n    fi\n\n    # Add kubeconfig location\n    KIND_CMD=\"$KIND_CMD --kubeconfig $KIND_KUBECONFIG\"\n\n    # Create cluster\n    echo \"Running: $KIND_CMD\" >> \"$KIND_LOG_DIR/service.log\"\n    if eval \"$KIND_CMD\" 2>&1 | tee -a \"$KIND_LOG_DIR/service.log\"; then\n        echo \"✓ Cluster created successfully\" | tee -a \"$KIND_LOG_DIR/service.log\"\n\n        # Set KUBECONFIG for kubectl\n        export KUBECONFIG=\"$KIND_KUBECONFIG\"\n\n        # Wait for cluster to be ready\n        echo \"Waiting for cluster to be ready...\" | tee -a \"$KIND_LOG_DIR/service.log\"\n        kubectl wait --for=condition=Ready nodes --all --timeout=300s 2>&1 | tee -a \"$KIND_LOG_DIR/service.log\"\n\n        echo \"✓ Cluster is ready\" | tee -a \"$KIND_LOG_DIR/service.log\"\n        echo \"\" | tee -a \"$KIND_LOG_DIR/service.log\"\n        kubectl cluster-info 2>&1 | tee -a \"$KIND_LOG_DIR/service.log\"\n    else\n        echo \"✗ Failed to create cluster\" | tee -a \"$KIND_LOG_DIR/service.log\"\n        exit 1\n    fi\nfi\n\n# Keep service running\ntail -f /dev/null\n"
      }
    }
  },
  "packages": [
    {
      "attr_path": "coreutils",
      "broken": false,
      "derivation": "/nix/store/8v93k1i80z2y93mj93rsbdhslnhcb2g1-coreutils-9.8.drv",
      "description": "GNU Core Utilities",
      "install_id": "coreutils",
      "license": "GPL-3.0-or-later",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "coreutils-9.8",
      "pname": "coreutils",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:08:15.048857Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "9.8",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "info": "/nix/store/hwhpjxflkbf3r1z836ipapcfz6n7h6wi-coreutils-9.8-info",
        "out": "/nix/store/xpxisjpwldh5f8y8xniizja9fxvbsqln-coreutils-9.8"
      },
      "system": "aarch64-darwin",
      "group": "darwin-tools",
      "priority": 5
    },
    {
      "attr_path": "coreutils",
      "broken": false,
      "derivation": "/nix/store/9ca92mpckwfgmah2nzbi0pdwapx74ys9-coreutils-9.8.drv",
      "description": "GNU Core Utilities",
      "install_id": "coreutils",
      "license": "GPL-3.0-or-later",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "coreutils-9.8",
      "pname": "coreutils",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:18:26.274826Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "9.8",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "debug": "/nix/store/8mxdv3zkfd2bfhljny13rsxhn5j6psy5-coreutils-9.8-debug",
        "info": "/nix/store/24hcz4v2685kj2yfvd5mwnxd7f5iy3n7-coreutils-9.8-info",
        "out": "/nix/store/kmssz33v44ms58zc9v2gv2x019rh4s6h-coreutils-9.8"
      },
      "system": "aarch64-linux",
      "group": "darwin-tools",
      "priority": 5
    },
    {
      "attr_path": "coreutils",
      "broken": false,
      "derivation": "/nix/store/f0c37w0qlfdra5cfg0b6sj8my49f7a1j-coreutils-9.8.drv",
      "description": "GNU Core Utilities",
      "install_id": "coreutils",
      "license": "GPL-3.0-or-later",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "coreutils-9.8",
      "pname": "coreutils",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:29:21.635256Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "9.8",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "info": "/nix/store/ad47w3v8846x80kz9sbva6z24z48sx1g-coreutils-9.8-info",
        "out": "/nix/store/js4wzwhm6wv09mxv7lb2zrb25x4ai89g-coreutils-9.8"
      },
      "system": "x86_64-darwin",
      "group": "darwin-tools",
      "priority": 5
    },
    {
      "attr_path": "coreutils",
      "broken": false,
      "derivation": "/nix/store/qabf8kc1wl566y6vqgys523359nshnv3-coreutils-9.8.drv",
      "description": "GNU Core Utilities",
      "install_id": "coreutils",
      "license": "GPL-3.0-or-later",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "coreutils-9.8",
      "pname": "coreutils",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T03:00:54.459715Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "9.8",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "debug": "/nix/store/ypxgf9nwy3494f25isg2hpgwf506iy7p-coreutils-9.8-debug",
        "info": "/nix/store/skcdvhfcdq8wghkiw44j4jalzqi6y56g-coreutils-9.8-info",
        "out": "/nix/store/xs8scz9w9jp4hpqycx3n3bah5y07ymgj-coreutils-9.8"
      },
      "system": "x86_64-linux",
      "group": "darwin-tools",
      "priority": 5
    },
    {
      "attr_path": "airflow-full-3-1-1",
      "derivation": "/nix/store/16vl6k059wghhizb20fjpnq01dny45xw-airflow-full-3-1-1-3.1.1.drv",
      "description": "Apache Airflow 3.1.1 with multiple providers (Active Support, Python 3.9-3.12)",
      "install_id": "airflow",
      "locked_url": "https://github.com/barstoolbluz/airflow-nix-builds.git?rev=4be998207d41bdfb9dcea1c4107f5891a08b7c85",
      "name": "airflow-full-3-1-1-3.1.1",
      "pname": "airflow-full-3-1-1",
      "rev": "4be998207d41bdfb9dcea1c4107f5891a08b7c85",
      "rev_count": 9,
      "rev_date": "2025-11-04T02:16:53Z",
      "scrape_date": "2025-11-04T17:24:38.970938253Z",
      "stabilities": [
        "unstable"
      ],
      "version": "3.1.1",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/ph0xcid58q3qx08izvkpiii6l27cmckj-airflow-full-3-1-1-3.1.1"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "bat",
      "broken": false,
      "derivation": "/nix/store/g61bbk9rk22w1ax1p18zv5wfb675ws29-bat-0.26.0.drv",
      "description": "Cat(1) clone with syntax highlighting and Git integration",
      "install_id": "bat",
      "license": "[ Apache-2.0, MIT ]",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "bat-0.26.0",
      "pname": "bat",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:08:14.700296Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.26.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/m1s1wqd7nswi7jnlg146g0m3rsvsg9a7-bat-0.26.0"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "bat",
      "broken": false,
      "derivation": "/nix/store/6rh4yfkz53zgzzg2yl09x69w9c9qd8b2-bat-0.26.0.drv",
      "description": "Cat(1) clone with syntax highlighting and Git integration",
      "install_id": "bat",
      "license": "[ Apache-2.0, MIT ]",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "bat-0.26.0",
      "pname": "bat",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:18:25.817515Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.26.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/0am602vqa4zyl5m75na8gl47dk66zzid-bat-0.26.0"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "bat",
      "broken": false,
      "derivation": "/nix/store/0jmi4m11dp8sdwn47cbhifzs518cf7fr-bat-0.26.0.drv",
      "description": "Cat(1) clone with syntax highlighting and Git integration",
      "install_id": "bat",
      "license": "[ Apache-2.0, MIT ]",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "bat-0.26.0",
      "pname": "bat",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:29:21.295854Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.26.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/7f6piwxyq7g8lw0d61bzy9nvmq1lsxv7-bat-0.26.0"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "bat",
      "broken": false,
      "derivation": "/nix/store/dcxwgk3d8jlh0yxhlarnyn0dbhmsn6ai-bat-0.26.0.drv",
      "description": "Cat(1) clone with syntax highlighting and Git integration",
      "install_id": "bat",
      "license": "[ Apache-2.0, MIT ]",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "bat-0.26.0",
      "pname": "bat",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T03:00:53.952554Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.26.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/vsih714glpw1gdr86yrif87pf0cvj9ha-bat-0.26.0"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "curl",
      "broken": false,
      "derivation": "/nix/store/g9b4bixj0n0bv1vf9bz0kakq86hh24h4-curl-8.16.0.drv",
      "description": "Command line tool for transferring files with URL syntax",
      "install_id": "curl",
      "license": "curl",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "curl-8.16.0",
      "pname": "curl",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:08:15.120034Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "8.16.0",
      "outputs_to_install": [
        "bin",
        "man"
      ],
      "outputs": {
        "bin": "/nix/store/982cq6ga80yn9nghx479fbqqwf7kf8n1-curl-8.16.0-bin",
        "dev": "/nix/store/qxzi15y4apihsg2infxn66b6hz5lws3h-curl-8.16.0-dev",
        "devdoc": "/nix/store/bz1ap1ahksz62gz79h8anfhsyz1ir0jw-curl-8.16.0-devdoc",
        "man": "/nix/store/rsdippinyvz3myz505vi6sgx8vmh30px-curl-8.16.0-man",
        "out": "/nix/store/8fgfydjv40m1pw8bpwm30kxw24284fvg-curl-8.16.0"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "curl",
      "broken": false,
      "derivation": "/nix/store/iij2ckwkfzzc50q6yr4jrqxc4kqiyrz6-curl-8.16.0.drv",
      "description": "Command line tool for transferring files with URL syntax",
      "install_id": "curl",
      "license": "curl",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "curl-8.16.0",
      "pname": "curl",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:18:26.359385Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "8.16.0",
      "outputs_to_install": [
        "bin",
        "man"
      ],
      "outputs": {
        "bin": "/nix/store/qnakzidljavpz27az7gjkyydb7ckjg6r-curl-8.16.0-bin",
        "debug": "/nix/store/zxlv6n85qw1lzmx4xblgc0lz1vv0hg1f-curl-8.16.0-debug",
        "dev": "/nix/store/aypq6najvfyhzx4k80a1vy329qmqj9zb-curl-8.16.0-dev",
        "devdoc": "/nix/store/b7w1516fx1mywmkl9dqsm1rnjmpvz7a3-curl-8.16.0-devdoc",
        "man": "/nix/store/dfgh660rbbj8s3l3xvy8klmkks4pkg3w-curl-8.16.0-man",
        "out": "/nix/store/pl917hpmpx64fisdisv2zjmk09grvm4g-curl-8.16.0"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "curl",
      "broken": false,
      "derivation": "/nix/store/1ln4jpjmml6ndr42f2rbv21j8racgiik-curl-8.16.0.drv",
      "description": "Command line tool for transferring files with URL syntax",
      "install_id": "curl",
      "license": "curl",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "curl-8.16.0",
      "pname": "curl",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:29:21.679404Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "8.16.0",
      "outputs_to_install": [
        "bin",
        "man"
      ],
      "outputs": {
        "bin": "/nix/store/irf7vpckgi9128jh7by1438ns3qgvfqz-curl-8.16.0-bin",
        "dev": "/nix/store/sv8p7spya9zf0163xb454wvl7jbmws57-curl-8.16.0-dev",
        "devdoc": "/nix/store/85fm556955nskhdr8q66ny2fk4fggzh1-curl-8.16.0-devdoc",
        "man": "/nix/store/a6znnvphjwyzhxjq8vbkr35ng6xglbfb-curl-8.16.0-man",
        "out": "/nix/store/sfr307vn71cyfnfmgckhwggq251rnrfr-curl-8.16.0"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "curl",
      "broken": false,
      "derivation": "/nix/store/yh73y300l9r1csw9zghd7im341rrp106-curl-8.16.0.drv",
      "description": "Command line tool for transferring files with URL syntax",
      "install_id": "curl",
      "license": "curl",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "curl-8.16.0",
      "pname": "curl",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T03:00:54.560041Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "8.16.0",
      "outputs_to_install": [
        "bin",
        "man"
      ],
      "outputs": {
        "bin": "/nix/store/xvh4bi0cc2cw18lpn6ax9m4zwnn1s9lj-curl-8.16.0-bin",
        "debug": "/nix/store/33lwk5v78214pmlnhphbijpvbh8gjbbq-curl-8.16.0-debug",
        "dev": "/nix/store/b65dj8iryqd1bss2qlg5ipxqndngcl9n-curl-8.16.0-dev",
        "devdoc": "/nix/store/bz67f9xwj2i7zanwkrxb6dy9bbm2283d-curl-8.16.0-devdoc",
        "man": "/nix/store/q4jbdyq7f0zks4i9xhfyx2pj6x92g9dj-curl-8.16.0-man",
        "out": "/nix/store/8np9zvwqmwsnbkbrwm8x7jq4ygdkjz5g-curl-8.16.0"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "jq",
      "broken": false,
      "derivation": "/nix/store/x0hycn9knfcq79i5habjgyz5akx7m7nr-jq-1.8.1.drv",
      "description": "Lightweight and flexible command-line JSON processor",
      "install_id": "jq",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "jq-1.8.1",
      "pname": "jq",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:08:30.388549Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "1.8.1",
      "outputs_to_install": [
        "bin",
        "man"
      ],
      "outputs": {
        "bin": "/nix/store/vh3xibzhaz3nl5m97ka2i5sxivv59sgn-jq-1.8.1-bin",
        "dev": "/nix/store/ni42jbsfngy5l81p2lz9v5wcl4kwl9nf-jq-1.8.1-dev",
        "doc": "/nix/store/hy9hxygqscjkz0faz5xlxwkj7sn6v74i-jq-1.8.1-doc",
        "man": "/nix/store/k9swya8a42jsa59jd2xcw0pvacj0xxyn-jq-1.8.1-man",
        "out": "/nix/store/qabxprfzl0lygph7yg3kq6b8si410syd-jq-1.8.1"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "jq",
      "broken": false,
      "derivation": "/nix/store/f2yda9q3f7miq3md0r47d25cbbwqwacw-jq-1.8.1.drv",
      "description": "Lightweight and flexible command-line JSON processor",
      "install_id": "jq",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "jq-1.8.1",
      "pname": "jq",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:18:46.543569Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "1.8.1",
      "outputs_to_install": [
        "bin",
        "man"
      ],
      "outputs": {
        "bin": "/nix/store/pqr9gww8fksrllfr38k9jvl7k5q5awf7-jq-1.8.1-bin",
        "dev": "/nix/store/qqcccyr96a1p4j7ywgzhqi06n5y47mk0-jq-1.8.1-dev",
        "doc": "/nix/store/ankng0jgm40wkgwiz3n8rj6hanmgdsx7-jq-1.8.1-doc",
        "man": "/nix/store/n0y7a3f5hmglwifndimclg99mpn554bl-jq-1.8.1-man",
        "out": "/nix/store/6h1mv44dhnq2jb94373cab59yaq5y8wz-jq-1.8.1"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "jq",
      "broken": false,
      "derivation": "/nix/store/yvb5zsm4ffb3k3216mry8zvpzn5sigm3-jq-1.8.1.drv",
      "description": "Lightweight and flexible command-line JSON processor",
      "install_id": "jq",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "jq-1.8.1",
      "pname": "jq",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:29:36.409900Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "1.8.1",
      "outputs_to_install": [
        "bin",
        "man"
      ],
      "outputs": {
        "bin": "/nix/store/r52fkpag200agnznp2var2p0f0d0i4ch-jq-1.8.1-bin",
        "dev": "/nix/store/ijwpwk35g7l8amallvhqymwnnspmxgcy-jq-1.8.1-dev",
        "doc": "/nix/store/zci6xwc00v98flb0jqhdaac0231pmgvb-jq-1.8.1-doc",
        "man": "/nix/store/xbvg59a0kdin1fibnqrw4l445a5dh9bc-jq-1.8.1-man",
        "out": "/nix/store/50fm8yn7mpxfks0cvrjifi58r90q5c6h-jq-1.8.1"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "jq",
      "broken": false,
      "derivation": "/nix/store/qk16np2i3ls20ih6n8lc38l6f3y6s7i3-jq-1.8.1.drv",
      "description": "Lightweight and flexible command-line JSON processor",
      "install_id": "jq",
      "license": "MIT",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "jq-1.8.1",
      "pname": "jq",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T03:01:16.369852Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "1.8.1",
      "outputs_to_install": [
        "bin",
        "man"
      ],
      "outputs": {
        "bin": "/nix/store/frzsv47z1mcyrp941zab08mx6kardizi-jq-1.8.1-bin",
        "dev": "/nix/store/caq8n6m9m5zyhf0by83ksbimqmpggkwr-jq-1.8.1-dev",
        "doc": "/nix/store/n3wl5jkmnzfg0a1vjxxx8w2n7js1b5sr-jq-1.8.1-doc",
        "man": "/nix/store/rs84gk428azdd7ca46ki3w60yqp54ksk-jq-1.8.1-man",
        "out": "/nix/store/zsw99s8nv2qffdg47jf8x8pyml9b0x2r-jq-1.8.1"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "kind",
      "broken": false,
      "derivation": "/nix/store/djdid6hdgv4dr94svch67kpk7c928q7h-kind-0.30.0.drv",
      "description": "Kubernetes IN Docker - local clusters for testing Kubernetes",
      "install_id": "kind",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "kind-0.30.0",
      "pname": "kind",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:08:30.833387Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.30.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/0jqqgl8vg7ppk70zgagfbv7maydcz2r4-kind-0.30.0"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "kind",
      "broken": false,
      "derivation": "/nix/store/hir1dmhvfn0vd1lhql3x35b8j9dwcxhm-kind-0.30.0.drv",
      "description": "Kubernetes IN Docker - local clusters for testing Kubernetes",
      "install_id": "kind",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "kind-0.30.0",
      "pname": "kind",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:18:47.812710Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.30.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/4fh21i34gifqz12d2kbk2r14xyh4m885-kind-0.30.0"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "kind",
      "broken": false,
      "derivation": "/nix/store/5rg8s4vashvs6q456bnn9x1gzhiy80ma-kind-0.30.0.drv",
      "description": "Kubernetes IN Docker - local clusters for testing Kubernetes",
      "install_id": "kind",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "kind-0.30.0",
      "pname": "kind",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:29:36.824914Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.30.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/ip0ba3b4dgp7b6bivdshf1x668hh72cc-kind-0.30.0"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "kind",
      "broken": false,
      "derivation": "/nix/store/691x0jc2injxir4iyqallhf69mnddx7z-kind-0.30.0.drv",
      "description": "Kubernetes IN Docker - local clusters for testing Kubernetes",
      "install_id": "kind",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "kind-0.30.0",
      "pname": "kind",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T03:01:17.670978Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "0.30.0",
      "outputs_to_install": [
        "out"
      ],
      "outputs": {
        "out": "/nix/store/wrznv97xc63ijk541f95zyzn09s6qlzy-kind-0.30.0"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "kubectl",
      "broken": false,
      "derivation": "/nix/store/4s4iqkg19cn9d64l0vss4szckhbyddh5-kubectl-1.34.1.drv",
      "description": "Kubernetes CLI",
      "install_id": "kubectl",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "kubectl-1.34.1",
      "pname": "kubectl",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:08:31.064866Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "1.34.1",
      "outputs_to_install": [
        "man",
        "out"
      ],
      "outputs": {
        "convert": "/nix/store/ciffxa4czjlmjzmq4yq21l8zkjvadxsq-kubectl-1.34.1-convert",
        "man": "/nix/store/5xfa19i31d4vhvbjihf6inqbp410fsp5-kubectl-1.34.1-man",
        "out": "/nix/store/pv5lknr9a985cdmxy0zqg0vk0562w1js-kubectl-1.34.1"
      },
      "system": "aarch64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "kubectl",
      "broken": false,
      "derivation": "/nix/store/k9d0hb2s3q1npazrx10sz4bysjkic2si-kubectl-1.34.1.drv",
      "description": "Kubernetes CLI",
      "install_id": "kubectl",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "kubectl-1.34.1",
      "pname": "kubectl",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:18:48.222261Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "1.34.1",
      "outputs_to_install": [
        "man",
        "out"
      ],
      "outputs": {
        "convert": "/nix/store/hhdzbn767znxinwswfqab0d0bg2jpwln-kubectl-1.34.1-convert",
        "man": "/nix/store/0s8wk88y5rnvnbgsy77x3ak02fnsq01i-kubectl-1.34.1-man",
        "out": "/nix/store/8xfnh8k465mm5q2cnh83hqk3h4p9i9n2-kubectl-1.34.1"
      },
      "system": "aarch64-linux",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "kubectl",
      "broken": false,
      "derivation": "/nix/store/d4x50hyr7wim6gxpc5mk3w80mq6zfrs7-kubectl-1.34.1.drv",
      "description": "Kubernetes CLI",
      "install_id": "kubectl",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "kubectl-1.34.1",
      "pname": "kubectl",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T02:29:37.032823Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "1.34.1",
      "outputs_to_install": [
        "man",
        "out"
      ],
      "outputs": {
        "convert": "/nix/store/0msa3w7f7bazgfpa2icmz7fkvcdrn4d7-kubectl-1.34.1-convert",
        "man": "/nix/store/qf79cl59w1kga58030s9a9nvk2b3m1qc-kubectl-1.34.1-man",
        "out": "/nix/store/80mql1xb9i7l5pb9cs5kmmgxhp351lv1-kubectl-1.34.1"
      },
      "system": "x86_64-darwin",
      "group": "toplevel",
      "priority": 5
    },
    {
      "attr_path": "kubectl",
      "broken": false,
      "derivation": "/nix/store/gnd8gwjpf3q8mi21dydc2nzw87npbva4-kubectl-1.34.1.drv",
      "description": "Kubernetes CLI",
      "install_id": "kubectl",
      "license": "Apache-2.0",
      "locked_url": "https://github.com/flox/nixpkgs?rev=6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "name": "kubectl-1.34.1",
      "pname": "kubectl",
      "rev": "6a08e6bb4e46ff7fcbb53d409b253f6bad8a28ce",
      "rev_count": 883951,
      "rev_date": "2025-10-25T06:24:58Z",
      "scrape_date": "2025-10-27T03:01:18.131749Z",
      "stabilities": [
        "unstable"
      ],
      "unfree": false,
      "version": "1.34.1",
      "outputs_to_install": [
        "man",
        "out"
      ],
      "outputs": {
        "convert": "/nix/store/aq74byw89ckq4hiw85gl2cq4c8h99wqi-kubectl-1.34.1-convert",
        "man": "/nix/store/g5wlm6mrnf1pgjqapfb5r8zkh37rizgf-kubectl-1.34.1-man",
        "out": "/nix/store/hkdsjac8x7pvq0lmazmg7qs6y8k6kayh-kubectl-1.34.1"
      },
      "system": "x86_64-linux",
      "group": "toplevel",
      "priority": 5
    }
  ],
  "compose": {
    "composer": {
      "version": 1,
      "install": {
        "airflow": {
          "pkg-path": "barstoolbluz/airflow-full-3-1-1",
          "systems": [
            "x86_64-linux"
          ]
        },
        "kubectl": {
          "pkg-path": "kubectl"
        }
      },
      "vars": {
        "AIRFLOW_KUBE_CONFIG_DIR": "$FLOX_ENV_CACHE/k8s-config",
        "AIRFLOW_KUBE_LOG_DIR": "$FLOX_ENV_CACHE/k8s-logs",
        "AIRFLOW_KUBE_TEMPLATES_DIR": "$FLOX_ENV_CACHE/k8s-templates"
      },
      "hook": {
        "on-activate": "# Create required directories\nmkdir -p \"$FLOX_ENV_CACHE/k8s-config\"\nmkdir -p \"$FLOX_ENV_CACHE/k8s-templates\"\nmkdir -p \"$FLOX_ENV_CACHE/k8s-logs\"\n\n# === KUBERNETES CONNECTION ===\nexport AIRFLOW_KUBE_NAMESPACE=\"${AIRFLOW_KUBE_NAMESPACE:-default}\"\nexport AIRFLOW_KUBE_CONFIG=\"${AIRFLOW_KUBE_CONFIG:-$KIND_KUBECONFIG}\"\nexport AIRFLOW_KUBE_IN_CLUSTER=\"${AIRFLOW_KUBE_IN_CLUSTER:-False}\"\n\n# === POD CONFIGURATION ===\nexport AIRFLOW_KUBE_IMAGE_PULL_POLICY=\"${AIRFLOW_KUBE_IMAGE_PULL_POLICY:-IfNotPresent}\"\nexport AIRFLOW_KUBE_DELETE_WORKER_PODS=\"${AIRFLOW_KUBE_DELETE_WORKER_PODS:-True}\"\nexport AIRFLOW_KUBE_DELETE_WORKER_PODS_ON_FAILURE=\"${AIRFLOW_KUBE_DELETE_WORKER_PODS_ON_FAILURE:-False}\"\nexport AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT=\"${AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT:-airflow}\"\n\n# === RESOURCE LIMITS ===\nexport AIRFLOW_KUBE_WORKER_CPU_REQUEST=\"${AIRFLOW_KUBE_WORKER_CPU_REQUEST:-100m}\"\nexport AIRFLOW_KUBE_WORKER_CPU_LIMIT=\"${AIRFLOW_KUBE_WORKER_CPU_LIMIT:-1000m}\"\nexport AIRFLOW_KUBE_WORKER_MEM_REQUEST=\"${AIRFLOW_KUBE_WORKER_MEM_REQUEST:-512Mi}\"\nexport AIRFLOW_KUBE_WORKER_MEM_LIMIT=\"${AIRFLOW_KUBE_WORKER_MEM_LIMIT:-2Gi}\"\n\n# === DERIVED PATHS ===\nexport AIRFLOW_KUBE_RBAC_CONFIG=\"$AIRFLOW_KUBE_CONFIG_DIR/rbac.yaml\"\nexport AIRFLOW_KUBE_POD_TEMPLATE=\"$AIRFLOW_KUBE_TEMPLATES_DIR/worker-pod-template.yaml\"\n\n# === GENERATE RBAC CONFIGURATION ===\ngenerate_rbac_config() {\n    cat > \"$AIRFLOW_KUBE_RBAC_CONFIG\" << EOF\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: airflow\n  namespace: $AIRFLOW_KUBE_NAMESPACE\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: airflow-role\n  namespace: $AIRFLOW_KUBE_NAMESPACE\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"pods\", \"pods/log\", \"pods/exec\"]\n    verbs: [\"get\", \"list\", \"watch\", \"create\", \"update\", \"delete\", \"patch\"]\n  - apiGroups: [\"\"]\n    resources: [\"configmaps\"]\n    verbs: [\"get\", \"list\", \"watch\"]\n  - apiGroups: [\"\"]\n    resources: [\"secrets\"]\n    verbs: [\"get\", \"list\"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: airflow-role-binding\n  namespace: $AIRFLOW_KUBE_NAMESPACE\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: airflow-role\nsubjects:\n  - kind: ServiceAccount\n    name: airflow\n    namespace: $AIRFLOW_KUBE_NAMESPACE\nEOF\n    chmod 644 \"$AIRFLOW_KUBE_RBAC_CONFIG\"\n    return 0\n}\n\n# === GENERATE POD TEMPLATE ===\ngenerate_pod_template() {\n    cat > \"$AIRFLOW_KUBE_POD_TEMPLATE\" << EOF\napiVersion: v1\nkind: Pod\nmetadata:\n  name: airflow-worker\n  namespace: $AIRFLOW_KUBE_NAMESPACE\nspec:\n  serviceAccountName: $AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT\n  containers:\n  - name: base\n    image: apache/airflow:3.1.1\n    imagePullPolicy: $AIRFLOW_KUBE_IMAGE_PULL_POLICY\n    resources:\n      requests:\n        cpu: \"$AIRFLOW_KUBE_WORKER_CPU_REQUEST\"\n        memory: \"$AIRFLOW_KUBE_WORKER_MEM_REQUEST\"\n      limits:\n        cpu: \"$AIRFLOW_KUBE_WORKER_CPU_LIMIT\"\n        memory: \"$AIRFLOW_KUBE_WORKER_MEM_LIMIT\"\n  restartPolicy: Never\nEOF\n    chmod 644 \"$AIRFLOW_KUBE_POD_TEMPLATE\"\n    return 0\n}\n\n# === VALIDATE KUBERNETES CONNECTION ===\nvalidate_k8s_connection() {\n    if [ ! -f \"$AIRFLOW_KUBE_CONFIG\" ]; then\n        echo \"⚠️  Warning: Kubeconfig not found: $AIRFLOW_KUBE_CONFIG\"\n        echo \"Make sure KIND cluster is started with: flox activate -s\"\n        return 1\n    fi\n\n    export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\n    if kubectl cluster-info > /dev/null 2>&1; then\n        return 0\n    else\n        echo \"⚠️  Warning: Cannot connect to Kubernetes cluster\"\n        echo \"Make sure KIND cluster is running\"\n        return 1\n    fi\n}\n\n# Generate configurations\ngenerate_rbac_config\ngenerate_pod_template\n\n# Validate connection (non-blocking)\nvalidate_k8s_connection\n\n# Display info\necho \"\"\necho \"✅ Airflow Kubernetes Executor environment ready\"\necho \"\"\necho \"Namespace: $AIRFLOW_KUBE_NAMESPACE\"\necho \"ServiceAccount: $AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT\"\necho \"\"\necho \"Resource Limits:\"\necho \"  CPU Request: $AIRFLOW_KUBE_WORKER_CPU_REQUEST\"\necho \"  CPU Limit: $AIRFLOW_KUBE_WORKER_CPU_LIMIT\"\necho \"  Memory Request: $AIRFLOW_KUBE_WORKER_MEM_REQUEST\"\necho \"  Memory Limit: $AIRFLOW_KUBE_WORKER_MEM_LIMIT\"\necho \"\"\necho \"Configuration Files:\"\necho \"  RBAC: $AIRFLOW_KUBE_RBAC_CONFIG\"\necho \"  Pod Template: $AIRFLOW_KUBE_POD_TEMPLATE\"\necho \"\"\necho \"Commands:\"\necho \"  flox activate -s        Setup Kubernetes RBAC\"\necho \"  k8s-airflow-info        Show configuration\"\necho \"  k8s-test-pod            Test pod creation\"\necho \"\"\n"
      },
      "profile": {
        "bash": "k8s-airflow-info() {\n    export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Airflow Kubernetes Executor Environment\"\n    echo \"\"\n    echo \"Namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"ServiceAccount: $AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT\"\n    echo \"Kubeconfig: $AIRFLOW_KUBE_CONFIG\"\n    echo \"\"\n    echo \"Resource Limits:\"\n    echo \"  CPU Request: $AIRFLOW_KUBE_WORKER_CPU_REQUEST\"\n    echo \"  CPU Limit: $AIRFLOW_KUBE_WORKER_CPU_LIMIT\"\n    echo \"  Memory Request: $AIRFLOW_KUBE_WORKER_MEM_REQUEST\"\n    echo \"  Memory Limit: $AIRFLOW_KUBE_WORKER_MEM_LIMIT\"\n    echo \"\"\n    echo \"Pod Configuration:\"\n    echo \"  Image Pull Policy: $AIRFLOW_KUBE_IMAGE_PULL_POLICY\"\n    echo \"  Delete Worker Pods: $AIRFLOW_KUBE_DELETE_WORKER_PODS\"\n    echo \"  Delete On Failure: $AIRFLOW_KUBE_DELETE_WORKER_PODS_ON_FAILURE\"\n    echo \"\"\n    echo \"Configuration Files:\"\n    echo \"  RBAC: $AIRFLOW_KUBE_RBAC_CONFIG\"\n    echo \"  Pod Template: $AIRFLOW_KUBE_POD_TEMPLATE\"\n    echo \"\"\n    echo \"Kubernetes Status:\"\n    if kubectl cluster-info > /dev/null 2>&1; then\n        kubectl get nodes 2>/dev/null | head -n 5\n        echo \"\"\n        echo \"ServiceAccount:\"\n        kubectl get sa airflow -n \"$AIRFLOW_KUBE_NAMESPACE\" 2>/dev/null || echo \"  (Not created yet - run: flox activate -s)\"\n    else\n        echo \"  ❌ Cannot connect to cluster\"\n    fi\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  kubectl get pods -n $AIRFLOW_KUBE_NAMESPACE       View Airflow pods\"\n    echo \"  kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE View ServiceAccount\"\n    echo \"  kubectl logs <pod> -n $AIRFLOW_KUBE_NAMESPACE     View pod logs\"\n    echo \"  k8s-test-pod                                       Test pod creation\"\n    echo \"  flox services logs k8s-setup                       View setup logs\"\n}\nexport -f k8s-airflow-info\n\nk8s-test-pod() {\n    export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Testing Airflow pod creation in namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"\"\n\n    kubectl run test-airflow-pod \\\n        --image=apache/airflow:3.1.1 \\\n        --namespace=\"$AIRFLOW_KUBE_NAMESPACE\" \\\n        --serviceaccount=airflow \\\n        --restart=Never \\\n        --rm -it \\\n        -- python --version\n\n    if [ $? -eq 0 ]; then\n        echo \"\"\n        echo \"✅ Pod creation successful\"\n    else\n        echo \"\"\n        echo \"❌ Pod creation failed\"\n        echo \"Check RBAC with: kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE\"\n    fi\n}\nexport -f k8s-test-pod\n",
        "zsh": "k8s-airflow-info() {\n    export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Airflow Kubernetes Executor Environment\"\n    echo \"\"\n    echo \"Namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"ServiceAccount: $AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT\"\n    echo \"Kubeconfig: $AIRFLOW_KUBE_CONFIG\"\n    echo \"\"\n    echo \"Resource Limits:\"\n    echo \"  CPU Request: $AIRFLOW_KUBE_WORKER_CPU_REQUEST\"\n    echo \"  CPU Limit: $AIRFLOW_KUBE_WORKER_CPU_LIMIT\"\n    echo \"  Memory Request: $AIRFLOW_KUBE_WORKER_MEM_REQUEST\"\n    echo \"  Memory Limit: $AIRFLOW_KUBE_WORKER_MEM_LIMIT\"\n    echo \"\"\n    echo \"Pod Configuration:\"\n    echo \"  Image Pull Policy: $AIRFLOW_KUBE_IMAGE_PULL_POLICY\"\n    echo \"  Delete Worker Pods: $AIRFLOW_KUBE_DELETE_WORKER_PODS\"\n    echo \"  Delete On Failure: $AIRFLOW_KUBE_DELETE_WORKER_PODS_ON_FAILURE\"\n    echo \"\"\n    echo \"Configuration Files:\"\n    echo \"  RBAC: $AIRFLOW_KUBE_RBAC_CONFIG\"\n    echo \"  Pod Template: $AIRFLOW_KUBE_POD_TEMPLATE\"\n    echo \"\"\n    echo \"Kubernetes Status:\"\n    if kubectl cluster-info > /dev/null 2>&1; then\n        kubectl get nodes 2>/dev/null | head -n 5\n        echo \"\"\n        echo \"ServiceAccount:\"\n        kubectl get sa airflow -n \"$AIRFLOW_KUBE_NAMESPACE\" 2>/dev/null || echo \"  (Not created yet - run: flox activate -s)\"\n    else\n        echo \"  ❌ Cannot connect to cluster\"\n    fi\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  kubectl get pods -n $AIRFLOW_KUBE_NAMESPACE       View Airflow pods\"\n    echo \"  kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE View ServiceAccount\"\n    echo \"  kubectl logs <pod> -n $AIRFLOW_KUBE_NAMESPACE     View pod logs\"\n    echo \"  k8s-test-pod                                       Test pod creation\"\n    echo \"  flox services logs k8s-setup                       View setup logs\"\n}\n\nk8s-test-pod() {\n    export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Testing Airflow pod creation in namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"\"\n\n    kubectl run test-airflow-pod \\\n        --image=apache/airflow:3.1.1 \\\n        --namespace=\"$AIRFLOW_KUBE_NAMESPACE\" \\\n        --serviceaccount=airflow \\\n        --restart=Never \\\n        --rm -it \\\n        -- python --version\n\n    if [ $? -eq 0 ]; then\n        echo \"\"\n        echo \"✅ Pod creation successful\"\n    else\n        echo \"\"\n        echo \"❌ Pod creation failed\"\n        echo \"Check RBAC with: kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE\"\n    fi\n}\n",
        "fish": "function k8s-airflow-info\n    set -x KUBECONFIG \"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Airflow Kubernetes Executor Environment\"\n    echo \"\"\n    echo \"Namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"ServiceAccount: $AIRFLOW_KUBE_WORKER_SERVICE_ACCOUNT\"\n    echo \"Kubeconfig: $AIRFLOW_KUBE_CONFIG\"\n    echo \"\"\n    echo \"Resource Limits:\"\n    echo \"  CPU Request: $AIRFLOW_KUBE_WORKER_CPU_REQUEST\"\n    echo \"  CPU Limit: $AIRFLOW_KUBE_WORKER_CPU_LIMIT\"\n    echo \"  Memory Request: $AIRFLOW_KUBE_WORKER_MEM_REQUEST\"\n    echo \"  Memory Limit: $AIRFLOW_KUBE_WORKER_MEM_LIMIT\"\n    echo \"\"\n    echo \"Pod Configuration:\"\n    echo \"  Image Pull Policy: $AIRFLOW_KUBE_IMAGE_PULL_POLICY\"\n    echo \"  Delete Worker Pods: $AIRFLOW_KUBE_DELETE_WORKER_PODS\"\n    echo \"  Delete On Failure: $AIRFLOW_KUBE_DELETE_WORKER_PODS_ON_FAILURE\"\n    echo \"\"\n    echo \"Configuration Files:\"\n    echo \"  RBAC: $AIRFLOW_KUBE_RBAC_CONFIG\"\n    echo \"  Pod Template: $AIRFLOW_KUBE_POD_TEMPLATE\"\n    echo \"\"\n    echo \"Kubernetes Status:\"\n    if kubectl cluster-info > /dev/null 2>&1\n        kubectl get nodes 2>/dev/null | head -n 5\n        echo \"\"\n        echo \"ServiceAccount:\"\n        kubectl get sa airflow -n \"$AIRFLOW_KUBE_NAMESPACE\" 2>/dev/null; or echo \"  (Not created yet - run: flox activate -s)\"\n    else\n        echo \"  ❌ Cannot connect to cluster\"\n    end\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  kubectl get pods -n $AIRFLOW_KUBE_NAMESPACE       View Airflow pods\"\n    echo \"  kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE View ServiceAccount\"\n    echo \"  kubectl logs <pod> -n $AIRFLOW_KUBE_NAMESPACE     View pod logs\"\n    echo \"  k8s-test-pod                                       Test pod creation\"\n    echo \"  flox services logs k8s-setup                       View setup logs\"\nend\n\nfunction k8s-test-pod\n    set -x KUBECONFIG \"$AIRFLOW_KUBE_CONFIG\"\n\n    echo \"Testing Airflow pod creation in namespace: $AIRFLOW_KUBE_NAMESPACE\"\n    echo \"\"\n\n    kubectl run test-airflow-pod \\\n        --image=apache/airflow:3.1.1 \\\n        --namespace=\"$AIRFLOW_KUBE_NAMESPACE\" \\\n        --serviceaccount=airflow \\\n        --restart=Never \\\n        --rm -it \\\n        -- python --version\n\n    if test $status -eq 0\n        echo \"\"\n        echo \"✅ Pod creation successful\"\n    else\n        echo \"\"\n        echo \"❌ Pod creation failed\"\n        echo \"Check RBAC with: kubectl get sa airflow -n $AIRFLOW_KUBE_NAMESPACE\"\n    end\nend\n"
      },
      "options": {
        "systems": [
          "aarch64-darwin",
          "aarch64-linux",
          "x86_64-darwin",
          "x86_64-linux"
        ]
      },
      "services": {
        "k8s-setup": {
          "command": "export KUBECONFIG=\"$AIRFLOW_KUBE_CONFIG\"\n\necho \"=== Kubernetes Setup Service ===\" | tee \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\necho \"Starting at $(date)\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n\n# Wait for cluster to be ready\necho \"Waiting for cluster to be ready...\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\nif ! kubectl wait --for=condition=Ready nodes --all --timeout=120s 2>&1 | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"; then\n    echo \"❌ Cluster not ready\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n    exit 1\nfi\n\n# Create namespace\necho \"Creating namespace '$AIRFLOW_KUBE_NAMESPACE'...\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\nkubectl create namespace \"$AIRFLOW_KUBE_NAMESPACE\" --dry-run=client -o yaml | kubectl apply -f - 2>&1 | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n\n# Apply RBAC\necho \"Applying RBAC configuration...\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\nif kubectl apply -f \"$AIRFLOW_KUBE_RBAC_CONFIG\" 2>&1 | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"; then\n    echo \"✅ RBAC configured successfully\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\nelse\n    echo \"❌ Failed to apply RBAC\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n    exit 1\nfi\n\n# Verify ServiceAccount\necho \"\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\necho \"ServiceAccount created:\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\nkubectl get serviceaccount airflow -n \"$AIRFLOW_KUBE_NAMESPACE\" 2>&1 | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n\necho \"\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\necho \"✅ Kubernetes executor environment ready\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\necho \"Pod template available at: $AIRFLOW_KUBE_POD_TEMPLATE\" | tee -a \"$AIRFLOW_KUBE_LOG_DIR/setup.log\"\n\n# Keep service running\ntail -f /dev/null\n"
        }
      },
      "include": {
        "environments": [
          {
            "remote": "barstoolbluz/kind-headless"
          }
        ]
      }
    },
    "include": [
      {
        "manifest": {
          "version": 1,
          "install": {
            "bat": {
              "pkg-path": "bat"
            },
            "coreutils": {
              "pkg-path": "coreutils",
              "pkg-group": "darwin-tools"
            },
            "curl": {
              "pkg-path": "curl"
            },
            "jq": {
              "pkg-path": "jq"
            },
            "kind": {
              "pkg-path": "kind"
            },
            "kubectl": {
              "pkg-path": "kubectl"
            }
          },
          "vars": {
            "KIND_CONFIG_DIR": "$FLOX_ENV_CACHE/kind-config",
            "KIND_DATA_DIR": "$FLOX_ENV_CACHE/kind-data",
            "KIND_LOG_DIR": "$FLOX_ENV_CACHE/kind-logs"
          },
          "hook": {
            "on-activate": "# Create required directories\nmkdir -p \"$FLOX_ENV_CACHE/kind-config\"\nmkdir -p \"$FLOX_ENV_CACHE/kind-logs\"\nmkdir -p \"$FLOX_ENV_CACHE/kind-data\"\n\n# Runtime-configurable variables with defaults\nexport KIND_CLUSTER_NAME=\"${KIND_CLUSTER_NAME:-kind}\"\nexport KIND_CONFIG_FILE=\"${KIND_CONFIG_FILE:-$KIND_CONFIG_DIR/cluster.yaml}\"\nexport KIND_KUBECONFIG=\"${KIND_KUBECONFIG:-$KIND_DATA_DIR/kubeconfig}\"\nexport KIND_IMAGE=\"${KIND_IMAGE:-}\"\n\n# Generate default KIND config if not exists\nif [ ! -f \"$KIND_CONFIG_FILE\" ]; then\n    cat > \"$KIND_CONFIG_FILE\" << 'EOF'\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n- role: worker\nEOF\nfi\n\n# Display minimal info\necho \"\"\necho \"✅ KIND environment ready (headless mode)\"\necho \"\"\necho \"Cluster Name: $KIND_CLUSTER_NAME\"\necho \"Config File:  $KIND_CONFIG_FILE\"\necho \"\"\necho \"Start cluster: flox activate -s\"\necho \"Check status:  flox services status\"\necho \"Show info:     kind-info\"\necho \"\"\n"
          },
          "profile": {
            "bash": "kind-info() {\n    echo \"KIND Cluster (Headless Mode)\"\n    echo \"\"\n    echo \"Cluster Name: $KIND_CLUSTER_NAME\"\n    echo \"Config File:  $KIND_CONFIG_FILE\"\n    echo \"Kubeconfig:   $KIND_KUBECONFIG\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox activate -s        Start KIND cluster service\"\n    echo \"  flox services status    Check service status\"\n    echo \"  flox services logs kind View service logs\"\n    echo \"  kubectl cluster-info    Show cluster information\"\n    echo \"  kind get clusters       List KIND clusters\"\n    echo \"\"\n    echo \"Runtime Configuration:\"\n    echo \"  KIND_CLUSTER_NAME       Default: $KIND_CLUSTER_NAME\"\n    echo \"  KIND_CONFIG_FILE        Default: $KIND_CONFIG_FILE\"\n    echo \"  KIND_KUBECONFIG         Default: $KIND_KUBECONFIG\"\n    echo \"  KIND_IMAGE              Default: (latest)\"\n    echo \"\"\n    echo \"Example:\"\n    echo \"  KIND_CLUSTER_NAME=dev KIND_CONFIG_FILE=./my-config.yaml flox activate -s\"\n}\n\nreadme() {\n  local readme_path=\"$FLOX_ENV_PROJECT/README.md\"\n  if [[ \"$1\" == \"--refresh\" ]] || [ ! -s \"$readme_path\" ]; then\n    curl -sL \"https://raw.githubusercontent.com/barstoolbluz/floxenvs/main/kind-basic/README.md\" > \"$readme_path\" 2>/dev/null\n  fi\n  if command -v bat &>/dev/null; then\n    bat --language markdown \"$readme_path\" 2>/dev/null\n  else\n    cat \"$readme_path\" 2>/dev/null\n  fi\n}\n",
            "zsh": "kind-info() {\n    echo \"KIND Cluster (Headless Mode)\"\n    echo \"\"\n    echo \"Cluster Name: $KIND_CLUSTER_NAME\"\n    echo \"Config File:  $KIND_CONFIG_FILE\"\n    echo \"Kubeconfig:   $KIND_KUBECONFIG\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox activate -s        Start KIND cluster service\"\n    echo \"  flox services status    Check service status\"\n    echo \"  flox services logs kind View service logs\"\n    echo \"  kubectl cluster-info    Show cluster information\"\n    echo \"  kind get clusters       List KIND clusters\"\n    echo \"\"\n    echo \"Runtime Configuration:\"\n    echo \"  KIND_CLUSTER_NAME       Default: $KIND_CLUSTER_NAME\"\n    echo \"  KIND_CONFIG_FILE        Default: $KIND_CONFIG_FILE\"\n    echo \"  KIND_KUBECONFIG         Default: $KIND_KUBECONFIG\"\n    echo \"  KIND_IMAGE              Default: (latest)\"\n    echo \"\"\n    echo \"Example:\"\n    echo \"  KIND_CLUSTER_NAME=dev KIND_CONFIG_FILE=./my-config.yaml flox activate -s\"\n}\n\nreadme() {\n  local readme_path=\"$FLOX_ENV_PROJECT/README.md\"\n  if [[ \"$1\" == \"--refresh\" ]] || [ ! -s \"$readme_path\" ]; then\n    curl -sL \"https://raw.githubusercontent.com/barstoolbluz/floxenvs/main/kind-basic/README.md\" > \"$readme_path\" 2>/dev/null\n  fi\n  if command -v bat &>/dev/null; then\n    bat --language markdown \"$readme_path\" 2>/dev/null\n  else\n    cat \"$readme_path\" 2>/dev/null\n  fi\n}\n",
            "fish": "function kind-info\n    echo \"KIND Cluster (Headless Mode)\"\n    echo \"\"\n    echo \"Cluster Name: $KIND_CLUSTER_NAME\"\n    echo \"Config File:  $KIND_CONFIG_FILE\"\n    echo \"Kubeconfig:   $KIND_KUBECONFIG\"\n    echo \"\"\n    echo \"Commands:\"\n    echo \"  flox activate -s        Start KIND cluster service\"\n    echo \"  flox services status    Check service status\"\n    echo \"  flox services logs kind View service logs\"\n    echo \"  kubectl cluster-info    Show cluster information\"\n    echo \"  kind get clusters       List KIND clusters\"\n    echo \"\"\n    echo \"Runtime Configuration:\"\n    echo \"  KIND_CLUSTER_NAME       Default: $KIND_CLUSTER_NAME\"\n    echo \"  KIND_CONFIG_FILE        Default: $KIND_CONFIG_FILE\"\n    echo \"  KIND_KUBECONFIG         Default: $KIND_KUBECONFIG\"\n    echo \"  KIND_IMAGE              Default: (latest)\"\n    echo \"\"\n    echo \"Example:\"\n    echo \"  KIND_CLUSTER_NAME=dev KIND_CONFIG_FILE=./my-config.yaml flox activate -s\"\nend\n\nfunction readme\n  set readme_path \"$FLOX_ENV_PROJECT/README.md\"\n  if test \"$argv[1]\" = \"--refresh\"; or test ! -s \"$readme_path\"\n    curl -sL \"https://raw.githubusercontent.com/barstoolbluz/floxenvs/main/kind-basic/README.md\" > \"$readme_path\" 2>/dev/null\n  end\n  if command -v bat >/dev/null 2>&1\n    bat --language markdown \"$readme_path\" 2>/dev/null\n  else\n    cat \"$readme_path\" 2>/dev/null\n  end\nend\n"
          },
          "options": {
            "systems": [
              "aarch64-darwin",
              "aarch64-linux",
              "x86_64-darwin",
              "x86_64-linux"
            ]
          },
          "services": {
            "kind": {
              "command": "mkdir -p \"$KIND_LOG_DIR\"\nmkdir -p \"$KIND_DATA_DIR\"\n\n# Log startup\necho \"=== KIND Service Startup ===\" > \"$KIND_LOG_DIR/service.log\"\necho \"Starting at $(date)\" >> \"$KIND_LOG_DIR/service.log\"\necho \"KIND_CLUSTER_NAME = $KIND_CLUSTER_NAME\" >> \"$KIND_LOG_DIR/service.log\"\necho \"KIND_CONFIG_FILE = $KIND_CONFIG_FILE\" >> \"$KIND_LOG_DIR/service.log\"\n\n# Check if cluster already exists\nif kind get clusters 2>/dev/null | grep -q \"^${KIND_CLUSTER_NAME}$\"; then\n    echo \"Cluster '$KIND_CLUSTER_NAME' already exists\" | tee -a \"$KIND_LOG_DIR/service.log\"\nelse\n    echo \"Creating KIND cluster '$KIND_CLUSTER_NAME'...\" | tee -a \"$KIND_LOG_DIR/service.log\"\n\n    # Build kind create command\n    KIND_CMD=\"kind create cluster --name $KIND_CLUSTER_NAME\"\n\n    # Add config file if it exists\n    if [ -f \"$KIND_CONFIG_FILE\" ]; then\n        KIND_CMD=\"$KIND_CMD --config $KIND_CONFIG_FILE\"\n    fi\n\n    # Add image if specified\n    if [ -n \"$KIND_IMAGE\" ]; then\n        KIND_CMD=\"$KIND_CMD --image $KIND_IMAGE\"\n    fi\n\n    # Add kubeconfig location\n    KIND_CMD=\"$KIND_CMD --kubeconfig $KIND_KUBECONFIG\"\n\n    # Create cluster\n    echo \"Running: $KIND_CMD\" >> \"$KIND_LOG_DIR/service.log\"\n    if eval \"$KIND_CMD\" 2>&1 | tee -a \"$KIND_LOG_DIR/service.log\"; then\n        echo \"✓ Cluster created successfully\" | tee -a \"$KIND_LOG_DIR/service.log\"\n\n        # Set KUBECONFIG for kubectl\n        export KUBECONFIG=\"$KIND_KUBECONFIG\"\n\n        # Wait for cluster to be ready\n        echo \"Waiting for cluster to be ready...\" | tee -a \"$KIND_LOG_DIR/service.log\"\n        kubectl wait --for=condition=Ready nodes --all --timeout=300s 2>&1 | tee -a \"$KIND_LOG_DIR/service.log\"\n\n        echo \"✓ Cluster is ready\" | tee -a \"$KIND_LOG_DIR/service.log\"\n        echo \"\" | tee -a \"$KIND_LOG_DIR/service.log\"\n        kubectl cluster-info 2>&1 | tee -a \"$KIND_LOG_DIR/service.log\"\n    else\n        echo \"✗ Failed to create cluster\" | tee -a \"$KIND_LOG_DIR/service.log\"\n        exit 1\n    fi\nfi\n\n# Keep service running\ntail -f /dev/null\n"
            }
          }
        },
        "name": "kind-headless",
        "descriptor": {
          "remote": "barstoolbluz/kind-headless"
        }
      }
    ],
    "warnings": [
      {
        "warning": {
          "Overriding": [
            "install",
            "kubectl"
          ]
        },
        "higher_priority_name": "Current manifest"
      },
      {
        "warning": {
          "Overriding": [
            "options",
            "systems"
          ]
        },
        "higher_priority_name": "Current manifest"
      }
    ]
  }
}